const __vite__mapDeps = (
  i,
  m = __vite__mapDeps,
  d = m.f ||
    (m.f = [
      "assets/kj3wube4rfsfjz3o.js",
      "assets/nbz4aahqzuixvvgr.js",
      "assets/hgyrt6j47bbfyjrt.js",
      "assets/lip667d8t42poxum.js",
      "assets/root-nsehtib5.css",
      "assets/bek4a02po1hapmml.js",
      "assets/conversation-small-k5k9c71c.css",
      "assets/accwyue32xah1z1m.js",
      "assets/gzhfufyiohn83kuo.js",
      "assets/mrja6mbtdpn27l02.js",
      "assets/gfnsbm99dy8f9dle.js",
      "assets/gkp5860wafdf24mv.js",
      "assets/jwvxkjptpstk4ej7.js",
      "assets/iz4edp1i5ofqfno9.js",
      "assets/k67sl0lg9wwjvh4l.js",
      "assets/cdsknz6b5nh9ccla.js",
      "assets/ifudxwcshv6o7k26.js",
      "assets/d3y72ugnrmac5z1v.js",
      "assets/eef33l65z4kyipsv.js",
    ]),
) => i.map((i) => d[i]);
import {
  R as ge,
  c as D,
  a as Wt,
  r as h,
  j as t,
  M as y,
  g as ce,
  d as Re,
  f as A,
  L as $t,
  a6 as de,
  a5 as z,
  u as Vt,
} from "./lip667d8t42poxum.js";
import {
  nD as at,
  km as nt,
  rB as Qt,
  j9 as M,
  j_ as qt,
  kr as Kt,
  s6 as Xt,
  s7 as Yt,
  an as Q,
  s8 as Zt,
  ky as ze,
  S as De,
  s9 as Jt,
  sa as Ue,
  sb as es,
  sc as ts,
  sd as ss,
  se as Ie,
  sf as it,
  sg as Ne,
  pg as rt,
  sh as ye,
  bX as ot,
  ct as pe,
  kn as as,
  si as Fe,
  Q as ns,
  nK as is,
  M as rs,
  nA as os,
  eY as ls,
  sj as cs,
  sk as ds,
  og as us,
  hP as lt,
  sl as he,
  eC as ms,
  y as _e,
  sm as fs,
  kt as xs,
  sn as Se,
  U as K,
  aF as ct,
  bH as hs,
  bG as gs,
  so as ps,
  q as dt,
  sp as js,
  sq as bs,
  sr as ut,
  z as mt,
  ss as vs,
  st as ke,
  eH as ys,
  ko as Ss,
  kl as Ns,
  su as Le,
  sv as ws,
  sw as ks,
  sx as Cs,
  sy as Is,
  kH as _s,
  kI as Ms,
  sz as Ts,
  ls as ft,
  sA as Ps,
  sB as Es,
  sC as Os,
  f$ as Fs,
  sD as we,
  sE as Ls,
  sF as As,
  sG as qe,
  sH as xt,
  sI as Bs,
  H as Rs,
  b_ as zs,
  sJ as Ds,
  kJ as ht,
  bJ as Ge,
  ek as gt,
  g_ as Us,
  sK as Gs,
  sL as Hs,
  sM as Ws,
  kC as $s,
  sN as Vs,
  sO as me,
  sP as Qs,
  hZ as qs,
  qB as Ks,
  sQ as Xs,
  sR as He,
  sS as Ys,
  sT as Zs,
  sU as Js,
  sV as ea,
  sW as ta,
  sX as sa,
  sY as Ke,
  sZ as aa,
  s_ as na,
  s$ as pt,
  I as ia,
  B as jt,
  f as ra,
  mG as oa,
  t0 as la,
  mB as ca,
  mH as da,
  t1 as bt,
  t2 as ua,
  t3 as ma,
  m$ as fa,
  dl as xa,
  dm as ha,
  t4 as ga,
  c4 as vt,
  ar as pa,
  fK as ja,
  fB as ba,
  aq as va,
  ay as ya,
  dt as Sa,
  t5 as yt,
  t6 as Na,
  t7 as wa,
  t8 as ka,
  t9 as Ca,
  hx as Ia,
  ta as _a,
  tb as Ma,
  f3 as Ta,
} from "./bek4a02po1hapmml.js";
import {
  F as St,
  gB as Pa,
  ao as ue,
  c as T,
  B as q,
  ce as Nt,
  cb as H,
  W as Be,
  at as wt,
  _ as le,
  g as U,
  ap as Ea,
  ae as Oa,
  t as kt,
  X as Ct,
  dj as It,
  b1 as Fa,
  v as _t,
  aj as L,
  cT as La,
  d9 as Mt,
  dg as Tt,
  bC as Aa,
  dR as Ba,
  p as Pt,
  aO as Ce,
  hk as Ra,
  m as za,
  e as Da,
  dh as Ua,
  a_ as Ga,
  di as Ha,
  aI as Wa,
  hl as $a,
  c6 as Va,
  c7 as Qa,
  gb as qa,
  as as Me,
  dm as Ka,
  dn as Xa,
  dp as Ya,
  dr as Za,
  dM as Ja,
  dt as en,
  du as tn,
  af as We,
  E as sn,
  cV as an,
  ag as Et,
  ai as Ot,
  e1 as nn,
  dX as Ft,
  s as rn,
  c0 as on,
  eu as ln,
  k as cn,
  cU as dn,
  fy as Lt,
  gv as X,
  et as un,
} from "./hgyrt6j47bbfyjrt.js";
import { e as At, h as mn, i as fn, j as $e } from "./ew9hb9iurj3kpkmu.js";
import { u as xn, H as hn, a as gn } from "./lug0xrczrlz6hmcb.js";
import { i as pn } from "./accwyue32xah1z1m.js";
import { G as Bt } from "./iamkd7uovamzrioo.js";
import { u as jn } from "./mrja6mbtdpn27l02.js";
import { W as Xe } from "./nhyrayi3co1h1g32.js";
import { P as bn } from "./d18ohowainhefjl7.js";
const Ye = ce({
  unableToLoadHistory: {
    id: "history.unableToLoad",
    defaultMessage: "Unable to load history",
  },
  retryButton: {
    id: "history.retryButton",
    defaultMessage: "Retry",
  },
});

function vn(s) {
  const e = JSON.stringify(s.map((n) => [n.id, n.title, n.update_time]));
  return h.useMemo(() => s, [e]);
}

function yn(s) {
  "use forget";
  const e = D.c(57),
    { activeId: a, hideOverflowMenu: n } = s,
    r = Wt(),
    [i, c] = h.useState(!1),
    [o, d] = h.useState(0),
    m = Pa(),
    [f, u] = h.useState(!1),
    l = at(),
    x = nt();
  let g;
  e[0] === Symbol.for("react.memo_cache_sentinel")
    ? ((g = {}), (e[0] = g))
    : (g = e[0]);
  const {
      conversations: S,
      hasNextPage: j,
      fetchNextPage: v,
      isLoading: p,
      isFetchingNextPage: k,
      isError: N,
    } = Qt(g),
    C = vn(S),
    I = h.useRef(null);
  let b;
  e[1] !== j || e[2] !== p || e[3] !== v
    ? ((b = (F) => {
        p ||
          F == null ||
          (I.current?.disconnect(),
          (I.current = new IntersectionObserver((Ht) => {
            Ht[0].isIntersecting && j && v();
          })),
          I.current.observe(F));
      }),
      (e[1] = j),
      (e[2] = p),
      (e[3] = v),
      (e[4] = b))
    : (b = e[4]);
  const _ = b;
  let w, E;
  e[5] === Symbol.for("react.memo_cache_sentinel")
    ? ((w = () => () => {
        I.current?.disconnect();
      }),
      (E = []),
      (e[5] = w),
      (e[6] = E))
    : ((w = e[5]), (E = e[6])),
    h.useEffect(w, E);
  let P, W;
  e[7] !== C
    ? ((P = () => {
        Nt.publish({
          kind: "refreshHistory",
          conversations: C,
        });
      }),
      (W = [C]),
      (e[7] = C),
      (e[8] = P),
      (e[9] = W))
    : ((P = e[8]), (W = e[9])),
    h.useEffect(P, W);
  const O = C;
  let G, je;
  e[10] !== o || e[11] !== m
    ? ((G = () => {
        const F = Xt(Yt(), Date.now());
        m(() => {
          d(o + 1);
        }, F + 1e3);
      }),
      (je = [o, m]),
      (e[10] = o),
      (e[11] = m),
      (e[12] = G),
      (e[13] = je))
    : ((G = e[12]), (je = e[13])),
    h.useEffect(G, je);
  const B = O.length === 0;
  M.markStart("History", M.NS_SIDEBAR),
    ue() != null && !p && M.markRendered("History", M.NS_SIDEBAR);
  const Pe = xn(O, o);
  let be;
  e[14] !== l
    ? ((be =
        l != null &&
        l.kind === "conversation" &&
        l.gizmoId != null &&
        qt(l.gizmoId)),
      (e[14] = l),
      (e[15] = be))
    : (be = e[15]);
  const R = be,
    Y = h.useRef(0),
    Ee = p || N || B;
  let Z;
  e[16] !== R
    ? ((Z = (F) => {
        F.preventDefault(), R && u(!0);
      }),
      (e[16] = R),
      (e[17] = Z))
    : (Z = e[17]);
  let J;
  e[18] !== R || e[19] !== l || e[20] !== x
    ? ((J = (F) => {
        F.preventDefault(),
          R &&
            ((Y.current = 0),
            u(!1),
            x({
              newGizmoId: null,
              conversation: l.conversation,
              previousGizmoId: l.gizmoId ?? null,
            }));
      }),
      (e[18] = R),
      (e[19] = l),
      (e[20] = x),
      (e[21] = J))
    : (J = e[21]);
  let ee, te;
  e[22] !== R
    ? ((ee = (F) => {
        F.preventDefault(), R && (Y.current = Y.current + 1);
      }),
      (te = (F) => {
        F.preventDefault(),
          R && ((Y.current = Y.current - 1), Y.current === 0 && u(!1));
      }),
      (e[22] = R),
      (e[23] = ee),
      (e[24] = te))
    : ((ee = e[23]), (te = e[24]));
  const Oe = f && "opacity-50";
  let se;
  e[25] !== Oe ? ((se = T(Oe)), (e[25] = Oe), (e[26] = se)) : (se = e[26]);
  let ae;
  e[27] !== B || e[28] !== p
    ? ((ae =
        B &&
        p &&
        t.jsx(H, {
          children: t.jsx(Be, {
            className: "m-auto",
          }),
        })),
      (e[27] = B),
      (e[28] = p),
      (e[29] = ae))
    : (ae = e[29]);
  let ne;
  e[30] !== i || e[31] !== B || e[32] !== N || e[33] !== r
    ? ((ne =
        B &&
        N &&
        t.jsxs("div", {
          className: "text-token-text-tertiary p-3 text-center italic",
          children: [
            t.jsx(y, {
              ...Ye.unableToLoadHistory,
            }),
            !i &&
              t.jsx("div", {
                className: "mt-1",
                children: t.jsx(q, {
                  as: "button",
                  color: "primary",
                  size: "small",
                  className: "m-auto mt-2",
                  onClick: () => {
                    c(!0), Kt(r);
                  },
                  children: t.jsx(y, {
                    ...Ye.retryButton,
                  }),
                }),
              }),
          ],
        })),
      (e[30] = i),
      (e[31] = B),
      (e[32] = N),
      (e[33] = r),
      (e[34] = ne))
    : (ne = e[34]);
  let ie;
  e[35] !== a ||
  e[36] !== Pe ||
  e[37] !== j ||
  e[38] !== n ||
  e[39] !== _ ||
  e[40] !== B ||
  e[41] !== p ||
  e[42] !== O
    ? ((ie =
        !p &&
        !B &&
        t.jsx("div", {
          children: t.jsx(hn, {
            activeId: a,
            bucketedItems: Pe,
            hasNextPage: j,
            items: O,
            infiniteScrollTriggerElementRef: _,
            hideOverflowMenu: n,
          }),
        })),
      (e[35] = a),
      (e[36] = Pe),
      (e[37] = j),
      (e[38] = n),
      (e[39] = _),
      (e[40] = B),
      (e[41] = p),
      (e[42] = O),
      (e[43] = ie))
    : (ie = e[43]);
  let re;
  e[44] !== k
    ? ((re =
        k &&
        t.jsx("div", {
          className: "m-4 mb-5 flex justify-center",
          children: t.jsx(Be, {}),
        })),
      (e[44] = k),
      (e[45] = re))
    : (re = e[45]);
  let ve;
  return (
    e[46] !== Ee ||
    e[47] !== Z ||
    e[48] !== J ||
    e[49] !== ee ||
    e[50] !== te ||
    e[51] !== se ||
    e[52] !== ae ||
    e[53] !== ne ||
    e[54] !== ie ||
    e[55] !== re
      ? ((ve = t.jsxs(Nn, {
          id: "history",
          $centered: Ee,
          onDragOver: Z,
          onDrop: J,
          onDragEnter: ee,
          onDragLeave: te,
          className: se,
          children: [ae, ne, ie, re],
        })),
        (e[46] = Ee),
        (e[47] = Z),
        (e[48] = J),
        (e[49] = ee),
        (e[50] = te),
        (e[51] = se),
        (e[52] = ae),
        (e[53] = ne),
        (e[54] = ie),
        (e[55] = re),
        (e[56] = ve))
      : (ve = e[56]),
    ve
  );
}
const Sn = ge.memo(yn),
  Nn = St.div`flex flex-col gap-2 text-token-text-primary text-sm mt-5 first:mt-0
${({ $centered: s }) => [s && "h-full justify-center items-center empty:hidden"]}`;

function Ve() {
  return (pn() ? "âŒ˜" : "Ctrl") + " K";
}

function wn({ children: s, className: e }) {
  return (
    M.markStart("FannyPackSearchTooltip", M.NS_SIDEBAR),
    M.markRendered("FannyPackSearchTooltip", M.NS_SIDEBAR),
    t.jsx(Q, {
      className: e,
      label: t.jsx(Zt, {
        children: t.jsx(y, {
          id: "jmd8WH",
          defaultMessage: "Search chats",
        }),
        keyboardShortcut: Ve(),
      }),
      children: s,
    })
  );
}

function kn({ className: s }) {
  return (
    h.useEffect(() => {
      wt.addAction("fannypack.web.action_seen"),
        le(
          () => import("./kj3wube4rfsfjz3o.js").then((e) => e.d),
          __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),
        );
    }, []),
    t.jsx(wn, {
      className: T("flex", s),
      children: t.jsx(ze, {
        "aria-label": Ve(),
        onClick: () => {
          le(
            () => import("./kj3wube4rfsfjz3o.js").then((e) => e.d),
            __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),
          ).then((e) => e.openFannyPackSearch());
        },
        icon: De,
      }),
    })
  );
}

function Cn({ isNewConversation: s }) {
  const e = U(),
    a = ue(),
    { data: n } = Ea(a?.id),
    r = a?.isEnterprisey() ? (n?.beta_settings.wham_access ?? !1) : !0,
    i = Jt(),
    { value: c } = Oa("2113934735"),
    o = a?.isQuorum(),
    d = Ue(e);
  return (
    M.markStart("OperatorSidebarListItem", M.NS_SIDEBAR),
    c
      ? c && M.markRendered("OperatorSidebarListItem", M.NS_SIDEBAR)
      : M.cancelRender("OperatorSidebarListItem", M.NS_SIDEBAR),
    t.jsxs(t.Fragment, {
      children: [
        !d &&
          t.jsx(In, {
            account: a,
            isNewConversation: s,
          }),
        !o &&
          t.jsxs(t.Fragment, {
            children: [
              null,
              r ? t.jsx(es, {}) : null,
              c ? t.jsx(ts, {}) : null,
              i ? t.jsx(ss, {}) : null,
              null,
            ],
          }),
      ],
    })
  );
}
const In = ({ account: s, isNewConversation: e }) => {
  const a = U(),
    n = Re(),
    r = A();
  let i;
  return s == null
    ? null
    : ((i = rt),
      t.jsx("div", {
        className: "bg-token-bg-elevated-secondary pt-0",
        children: t.jsx(Q, {
          side: "right",
          label: r.formatMessage(Ne.newChat),
          className: "flex w-full items-center",
          children: t.jsx(Ie, {
            className:
              "group w-full duration-100 not-only-of-type:flex-1 active:scale-[0.98] motion-safe:transition-transform",
            loggingGizmoId: "primary",
            href: "/",
            onClick: (c) => {
              !kt(a) && !e
                ? (c.preventDefault(), it(n))
                : Nt.publish({
                    kind: "newChatRequested",
                  });
            },
            icon: t.jsx(Bt, {
              isFirstParty: !0,
              className: "h-6 w-6",
              "aria-label": "",
            }),
            isMenuOpen: !1,
            label: i,
            hoverRightIcon: null,
          }),
        }),
      }));
};

function _n({
  gizmoResource: s,
  serverThreadId: e,
  isOnProjectPage: a,
  conversations: n,
  hasNextPage: r = !1,
}) {
  const i = U(),
    c = n ?? [],
    o = c.findIndex((f) => f.id === e),
    d = c.slice(0, ye);
  o != null && o >= ye && (d[ye - 1] = c[o]);
  const m = r || c.length > ye;
  return t.jsxs("div", {
    className: "screen-arch:gap-0.5 flex flex-col",
    children: [
      d.map((f) =>
        t.jsx(
          gn,
          {
            className: "ms-7 ps-1",
            item: f,
            isActive: f.id === e,
          },
          f.id,
        ),
      ),
      m &&
        !a &&
        t.jsx($t, {
          to: ot(i, s),
          className:
            "group tracking-condensed text-token-text-primary hover:bg-token-sidebar-surface-secondary ms-7 flex h-9 items-center gap-2.5 rounded-lg ps-3 pe-2 text-sm",
          children: t.jsx("span", {
            className: "text-start",
            children: t.jsx(y, {
              ...pe.seeAllChats,
            }),
          }),
        }),
    ],
  });
}
const Mn = Ct(
    () =>
      le(
        () => import("./iz4edp1i5ofqfno9.js"),
        __vite__mapDeps([13, 3, 2, 4, 14]),
      ).then((s) => s.SnorlaxFolderAnimation),
    {
      loading: ({ color: s }) =>
        t.jsx(Rt, {
          color: s,
        }),
    },
  ),
  Tn = {
    open: {
      opacity: 1,
      y: 0,
      transition: {
        duration: 0.15,
        ease: "easeOut",
      },
    },
    closed: {
      opacity: 0,
      y: -5,
      transition: {
        duration: 0.15,
        ease: "easeIn",
      },
    },
  };

function Pn({
  color: s,
  folderState: e,
  gizmoId: a,
  sidebarSnorlaxFolderStore: n,
}) {
  const r = A(),
    [i, c] = h.useState(!1);
  return t.jsx(Q, {
    side: "top",
    delayDuration: 600,
    label:
      e === "open"
        ? r.formatMessage(pe.hideChatsForProjectTooltip)
        : r.formatMessage(pe.showChatsForProjectTooltip),
    children: t.jsx("button", {
      onClick: (o) => {
        o.preventDefault(),
          e === "open" ? n.collapseProject(a) : n.expandProject(a);
      },
      className:
        "text-token-text-secondary hover:bg-token-sidebar-surface-tertiary -m-0.5 flex rounded-xl p-0.5",
      onMouseEnter: () => {
        c(!0);
      },
      onMouseLeave: () => {
        c(!1);
      },
      children: t.jsx("div", {
        className: "h-6 w-6",
        children: t.jsx("div", {
          className:
            "text-token-text-primary relative flex h-full items-center justify-center",
          children: t.jsx(Mn, {
            isOpen: e === "open",
            isHovered: i,
            color: s,
          }),
        }),
      }),
    }),
  });
}

function Rt({ color: s }) {
  return t.jsx("div", {
    className:
      "text-token-text-primary flex h-6 w-6 shrink-0 items-center justify-center",
    children: t.jsx(as, {
      className: "h-3/4 w-3/4",
      style: {
        color: s,
      },
    }),
  });
}

function Te({
  gizmo: s,
  historyDisabled: e,
  section: a,
  onClick: n,
  isActive: r,
  hideOverflowMenu: i = !1,
  elementRef: c,
}) {
  const o = U(),
    { clientThreadId: d } = jn(),
    m = It(d),
    f = A(),
    [u, l] = h.useState(!1),
    x = s.gizmo.id,
    g = Fe.useStore(),
    S = Fe.useState((P) => Fe.selectFolderState(P, x)),
    j = Fa(),
    v = !!s.gizmo.tags?.includes(ns.FirstParty),
    p = at(),
    k = nt(),
    { items: N = [], hasNextPage: C } = is(s.gizmo.id),
    I = rs(x),
    b = os(s);
  let _ = !1;
  r && I && !(S === "open" && m) && (_ = !0),
    h.useEffect(() => {
      S !== "open" && r && m && g.expandProject(x);
    }, [r, m, g, x]);
  let w;
  if (s != null) w = s.gizmo.display.name || ls;
  else {
    if (j == null) return null;
    e ? (w = f.formatMessage(Ne.clearChat)) : (w = rt);
  }
  const E =
    p != null &&
    p.kind === "conversation" &&
    (p.gizmoId == null || p.gizmoId != x);
  return t.jsxs(t.Fragment, {
    children: [
      t.jsx("div", {
        className: "relative z-0 focus-within:z-20",
        onDrop: (P) => {
          P.preventDefault(),
            E &&
              k({
                newGizmoId: x,
                conversation: p.conversation,
                previousGizmoId: p.gizmoId ?? null,
              });
        },
        onDragOver: (P) => {
          P.preventDefault();
        },
        children: t.jsx(Ie, {
          loggingGizmoId: s?.gizmo.id ?? "primary",
          href: ot(o, s),
          onClick: n,
          showActiveIndicator: _,
          icon:
            I && N.length > 0
              ? t.jsx(Pn, {
                  color: b,
                  folderState: S,
                  gizmoId: x,
                  sidebarSnorlaxFolderStore: g,
                })
              : I
                ? t.jsx(Rt, {
                    color: b,
                  })
                : t.jsx(Bt, {
                    isFirstParty: v,
                    src: s?.gizmo.display.profile_picture_url,
                    className: "h-6 w-6 shrink-0",
                  }),
          isMenuOpen: u,
          label: w,
          rightIcon:
            a === he.Workspace &&
            t.jsx(Q, {
              side: "right",
              label: f.formatMessage(Ze.workspaceRecommended, {
                workspace_name: j?.name ?? "Your Workspace",
              }),
              children: t.jsx(ms, {
                className: "icon-md text-token-text-secondary",
                alt: f.formatMessage(Ze.workspaceRecommended, {
                  workspace_name: j?.name ?? "Your Workspace",
                }),
              }),
            }),
          hoverRightIcon: t.jsxs("div", {
            className: "flex gap-2",
            children: [
              !i &&
                (I
                  ? t.jsx("div", {
                      className: T(
                        "text-token-text-tertiary can-hover:opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 focus-within:opacity-100",
                        u && "opacity-100!",
                      ),
                      onClick: (P) => {
                        P.preventDefault();
                      },
                      children: t.jsx(cs, {
                        gizmo: s,
                        isOpen: u,
                        setIsOpen: l,
                      }),
                    })
                  : t.jsx("div", {
                      className: T(
                        "text-token-text-tertiary can-hover:opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 focus-within:opacity-100",
                        u && "opacity-100!",
                      ),
                      onClick: (P) => {
                        P.preventDefault();
                      },
                      children: t.jsx(ds, {
                        gizmo: s,
                        isOpen: u,
                        setIsOpen: l,
                        section: a,
                      }),
                    })),
              !I &&
                !i &&
                t.jsx(Q, {
                  side: "right",
                  label: f.formatMessage(e ? Ne.clearChat : Ne.newChat),
                  className: "flex items-center",
                  children: t.jsx("button", {
                    className: u
                      ? "text-token-text-tertiary"
                      : "text-token-text-secondary hover:text-token-text-primary can-hover:opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 focus-within:opacity-100",
                    children: e
                      ? t.jsx(us, {
                          className: "icon-md",
                        })
                      : t.jsx(lt, {
                          className: "icon-md",
                        }),
                  }),
                }),
            ],
          }),
          elementRef: c,
        }),
      }),
      t.jsx(de, {
        initial: !1,
        children:
          I &&
          S === "open" &&
          N.length > 0 &&
          t.jsx(
            z.div,
            {
              initial: "closed",
              animate: "open",
              exit: "closed",
              variants: Tn,
              className: "overflow-hidden",
              children: t.jsx(_n, {
                gizmoResource: s,
                serverThreadId: m,
                isOnProjectPage: _,
                conversations: N,
                hasNextPage: C,
              }),
            },
            "nested-conversations",
          ),
      }),
    ],
  });
}
const Ze = ce({
    workspaceRecommended: {
      id: "gizmo.workspaceRecommended",
      defaultMessage: "Recommended at {workspace_name}",
    },
  }),
  En = 2;

function On({ gizmos: s, maxToShowOnLoad: e = 4, showAllSidebarItems: a }) {
  const n = xs(s, (l) => l.flair.kind),
    r = [
      ...(
        n[Se.Workspace]?.map(({ resource: l }) => ({
          gizmo: l,
          section: he.Workspace,
        })) ?? []
      ).slice(0, 3),
      ...(n[Se.FirstParty]?.map(({ resource: l }) => ({
        gizmo: l,
        section: he.Keep,
      })) ?? []),
      ...(n[Se.SidebarKeep]?.map(({ resource: l }) => ({
        gizmo: l,
        section: he.Keep,
      })) ?? []),
    ],
    i = n[Se.Recent] ?? [],
    o = (a ? i : i.slice(0, En)).map(({ resource: l }) => ({
      gizmo: l,
      section: he.Recents,
    })),
    d = r.length;
  let m = [];
  (m = [...r, ...o]),
    a ||
      (m.length > e && d > e
        ? (m = m.slice(0, d))
        : m.length > e && (m = m.slice(0, e)));
  const u = s.length > m.length;
  return {
    listItems: m,
    itemsLeft: s.length - m.length,
    needsToCollapseItems: u,
    total: s.length,
  };
}

function Fn(s) {
  "use forget";
  const e = D.c(19),
    {
      gizmo: a,
      currentGizmoId: n,
      maxToShowOnLoad: r,
      hideOverflowMenu: i,
    } = s,
    c = i === void 0 ? !1 : i,
    o = _e(Ln);
  let d, m, f;
  if (e[0] !== n || e[1] !== a || e[2] !== c || e[3] !== r || e[4] !== o) {
    const {
      listItems: g,
      needsToCollapseItems: S,
      itemsLeft: j,
    } = On({
      gizmos: a,
      maxToShowOnLoad: r,
      showAllSidebarItems: o,
    });
    (m = S), (d = j);
    let v;
    e[8] !== n || e[9] !== c
      ? ((v = function (N, C) {
          return t.jsx(
            Te,
            {
              gizmo: N,
              isActive: N.gizmo.id === n,
              section: C,
              hideOverflowMenu: c,
            },
            N.gizmo.id,
          );
        }),
        (e[8] = n),
        (e[9] = c),
        (e[10] = v))
      : (v = e[10]);
    const p = v;
    (f = g.map((k, N) => {
      const { gizmo: C, section: I } = k;
      return t.jsxs(
        h.Fragment,
        {
          children: [
            N > 1 &&
              I !== g[N - 1].section &&
              t.jsx("div", {
                className: "bg-token-border-default my-2 ms-2 h-px w-7",
              }),
            p(C, I),
          ],
        },
        N,
      );
    })),
      (e[0] = n),
      (e[1] = a),
      (e[2] = c),
      (e[3] = r),
      (e[4] = o),
      (e[5] = d),
      (e[6] = m),
      (e[7] = f);
  } else (d = e[5]), (m = e[6]), (f = e[7]);
  let u;
  e[11] !== d || e[12] !== m || e[13] !== o
    ? ((u = m
        ? t.jsxs("button", {
            onClick: K.toggleGptListCollapsed,
            className:
              "text-token-text-primary hover:bg-token-sidebar-surface-secondary flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm",
            children: [
              t.jsx("div", {
                className: "flex h-6 w-6 shrink-0 items-center justify-center",
                children: t.jsx(ct, {
                  className: "icon-md text-token-text-primary",
                }),
              }),
              t.jsx("div", {
                className: "flex grow items-center gap-1",
                children: o
                  ? t.jsxs(t.Fragment, {
                      children: [
                        t.jsx(y, {
                          id: "GizmoSidebarList.showLess",
                          defaultMessage: "See less",
                        }),
                        t.jsx(hs, {
                          className: "icon-xs",
                        }),
                      ],
                    })
                  : t.jsxs(t.Fragment, {
                      children: [
                        t.jsx(y, {
                          id: "GizmoSidebarList.showMoreItems",
                          defaultMessage: "{numMore} more",
                          values: {
                            numMore: d,
                          },
                        }),
                        t.jsx(gs, {
                          className: "icon-xs",
                        }),
                      ],
                    }),
              }),
            ],
          })
        : null),
      (e[11] = d),
      (e[12] = m),
      (e[13] = o),
      (e[14] = u))
    : (u = e[14]);
  let l;
  e[15] === Symbol.for("react.memo_cache_sentinel")
    ? ((l = t.jsx(ps, {})), (e[15] = l))
    : (l = e[15]);
  let x;
  return (
    e[16] !== f || e[17] !== u
      ? ((x = t.jsxs(t.Fragment, {
          children: [f, u, l],
        })),
        (e[16] = f),
        (e[17] = u),
        (e[18] = x))
      : (x = e[18]),
    x
  );
}

function Ln(s) {
  return !fs.isGptListCollapsed(s);
}

function Je() {
  "use forget";
  const s = D.c(1);
  if (!ue()) return null;
  let a;
  return (
    s[0] === Symbol.for("react.memo_cache_sentinel")
      ? ((a = t.jsx(zn, {})), (s[0] = a))
      : (a = s[0]),
    a
  );
}

function An(s) {
  "use forget";
  const e = D.c(2),
    { currentGizmoId: a } = s;
  if (!ue()) return null;
  let r;
  return (
    e[0] !== a
      ? ((r = t.jsx(Bn, {
          currentGizmoId: a,
        })),
        (e[0] = a),
        (e[1] = r))
      : (r = e[1]),
    r
  );
}

function Bn(s) {
  "use forget";
  const e = D.c(13),
    { currentGizmoId: a } = s,
    n = U();
  let r;
  e[0] !== n
    ? ((r = _t(n, "2152104812").get("hide_gpts_if_none", !1)),
      (e[0] = n),
      (e[1] = r))
    : (r = e[1]);
  const i = r,
    c = dt(),
    { data: o } = js();
  let d;
  e[2] !== o
    ? ((d = o === void 0 ? {} : o), (e[2] = o), (e[3] = d))
    : (d = e[3]);
  const { gizmos: m } = d;
  let f;
  e[4] !== m ? ((f = m ?? []), (e[4] = m), (e[5] = f)) : (f = e[5]);
  let u = f;
  if (c) {
    let x;
    e[6] !== u
      ? ((x = u.filter(Rn) ?? []), (e[6] = u), (e[7] = x))
      : (x = e[7]),
      (u = x);
  }
  let l;
  return (
    e[8] !== a || e[9] !== u || e[10] !== m?.length || e[11] !== i
      ? ((l =
          (!i || m?.length !== 0) &&
          t.jsx(Fn, {
            gizmo: u,
            currentGizmoId: a,
            maxToShowOnLoad: 7,
          })),
        (e[8] = a),
        (e[9] = u),
        (e[10] = m?.length),
        (e[11] = i),
        (e[12] = l))
      : (l = e[12]),
    l
  );
}

function Rn(s) {
  return !bs(s.resource);
}

function zn() {
  "use forget";
  const s = D.c(4),
    e = U();
  let a;
  s[0] !== e
    ? ((a = _t(e, "2152104812").get("hide_default_gpts", !1)),
      (s[0] = e),
      (s[1] = a))
    : (a = s[1]);
  const n = a;
  let r;
  return (
    s[2] !== n
      ? ((r =
          !n &&
          t.jsx(Cn, {
            isNewConversation: !0,
          })),
        (s[2] = n),
        (s[3] = r))
      : (r = s[3]),
    r
  );
}
const Dn = ({ onNewThread: s }) =>
    t.jsxs(t.Fragment, {
      children: [
        t.jsx(Gn, {
          onNewThread: s,
        }),
        t.jsx(Hn, {}),
        t.jsx(ut, {}),
        t.jsx(Un, {}),
      ],
    }),
  Un = () =>
    t.jsx("div", {
      className: "h-8",
    }),
  Gn = ({ onNewThread: s }) => {
    const e = A(),
      a = (n) => {
        K.setPopoverSidebarOpen(!1),
          n.metaKey || n.ctrlKey
            ? L.logEventWithStatsig(
                "New Chat Opened In New Tab",
                "chatgpt_new_chat_opened_in_new_tab",
              )
            : (n.preventDefault(), s());
      };
    return t.jsx(Ie, {
      loggingGizmoId: "primary",
      testId: "create-new-chat-button",
      href: "/",
      onClick: a,
      icon: t.jsx(lt, {
        className: "icon-md",
        "aria-label": "",
      }),
      isMenuOpen: !1,
      label: e.formatMessage({
        id: "6Abeg/",
        defaultMessage: "New chat",
      }),
      hoverRightIcon: null,
    });
  },
  Hn = () => {
    const s = A(),
      { isFannyPackEnabled: e } = mt();
    return (
      h.useEffect(() => {
        e &&
          (wt.addAction("fannypack.web.action_seen"),
          le(
            () => import("./kj3wube4rfsfjz3o.js").then((a) => a.d),
            __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),
          ));
      }, [e]),
      e
        ? t.jsx(Ie, {
            href: "#",
            onClick: (a) => {
              a.preventDefault(),
                K.setPopoverSidebarOpen(!1),
                le(
                  () => import("./kj3wube4rfsfjz3o.js").then((n) => n.d),
                  __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),
                ).then((n) => n.openFannyPackSearch());
            },
            icon: t.jsx(De, {
              className: "icon-md",
              "aria-label": "",
            }),
            isMenuOpen: !1,
            label: s.formatMessage({
              id: "bDEsvT",
              defaultMessage: "Search chats",
            }),
            hoverRightIcon: t.jsx("div", {
              className:
                "text-token-text-tertiary pe-1 not-group-hover:not-group-focus-visible:hidden",
              children: Ve(),
            }),
          })
        : null
    );
  };

function Wn({ currentGizmoId: s, onClick: e }) {
  const { isSidebarFlyoutOpen: a, onSidebarFlyoutOpenChange: n } = vs(),
    r = a(ke.Snorlax);
  return t.jsx("div", {
    className: "group flex w-full items-center justify-start",
    children: t.jsx(ys, {
      onOpenChange: (i) => n(ke.Snorlax, i),
      side: "right",
      sideOffset: 4,
      open: r,
      contentAlign: "end",
      triggerButton: t.jsxs("button", {
        className: T(
          "tracking-condensed text-token-text-secondary hover:bg-token-sidebar-surface-secondary screen-arch:py-[7px] screen-arch:text-body can-hover:hover:screen-arch:bg-token-main-surface-secondary flex flex-1 items-center gap-2.5 rounded-lg px-2 py-1.5 text-sm ease-[var(--spring-bounce)] select-none focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",
          r && "bg-token-main-surface-secondary",
        ),
        onClick: e,
        children: [
          t.jsx("div", {
            className: "h-6 w-6",
            children: t.jsx("div", {
              className:
                "text-token-text-primary relative flex h-full items-center justify-center",
              children: t.jsx(ct, {
                className: "icon-md text-token-sidebar-icon font-semibold",
              }),
            }),
          }),
          t.jsx("span", {
            className: "text-start",
            children: t.jsx(y, {
              ...pe.seeMoreProjectItems,
            }),
          }),
        ],
      }),
      size: "auto",
      children: t.jsx("div", {
        className:
          "max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",
        children: t.jsx(H, {
          children: t.jsx(Ss, {
            currentGizmoId: s,
            inSidebarFlyout: !0,
            customListItem: Te,
          }),
        }),
      }),
    }),
  });
}

function $n({ snorlaxes: s, currentGizmoId: e }) {
  return t.jsx(t.Fragment, {
    children: s.map((a) =>
      t.jsx(
        Te,
        {
          gizmo: a.gizmo,
          isActive: a.gizmo.gizmo.id === e,
        },
        a.gizmo.gizmo.id,
      ),
    ),
  });
}

function Vn({ currentGizmoId: s, includeRevisedSidebarIa: e }) {
  const a = A(),
    {
      snorlaxes: n,
      data: r,
      isLoading: i,
      isError: c,
      refetch: o,
      hasNextPage: d,
    } = Ns(),
    m = n.slice(0, Le),
    f = h.useRef(!1),
    [u, l] = h.useState(!0),
    x = h.useCallback(
      function (C) {
        C && l(!1), o();
      },
      [o, l],
    ),
    g = (n ?? []).length === 0,
    S = c || (r === void 0 && !i && f.current);
  M.markStart("SnorlaxSidebarList", M.NS_SIDEBAR),
    r != null && !i && M.markRendered("SnorlaxSidebarList", M.NS_SIDEBAR),
    r === void 0 && !i && !f.current && ((f.current = !0), x(!1));
  const v = n?.find((N) => N.gizmo.gizmo.id === s),
    p = m.some((N) => N.gizmo.gizmo.id === s),
    k = n && (n?.length > (!s || p ? Le : Le + 1) || d);
  return t.jsxs(t.Fragment, {
    children: [
      S &&
        t.jsx(ws, {
          showRetry: u,
          refetch: x,
        }),
      !S &&
        t.jsx(ks, {
          id: "snorlax-heading",
          condensed: e,
          header: t.jsxs(H, {
            children: [
              a.formatMessage(pe.projectsHeading),
              !g && t.jsx(Is, {}),
            ],
          }),
          isLastInGroup: !0,
          ulClassName: "screen-arch:mb-3",
          children:
            !i &&
            t.jsxs(t.Fragment, {
              children: [
                t.jsx($n, {
                  snorlaxes: m,
                  currentGizmoId: s,
                }),
                v &&
                  !p &&
                  t.jsx(Te, {
                    gizmo: v.gizmo,
                    isActive: !0,
                  }),
                k &&
                  t.jsx(Wn, {
                    currentGizmoId: s,
                  }),
                !i && g && t.jsx(Cs, {}),
              ],
            }),
        }),
    ],
  });
}

function Qn(s) {
  "use forget";
  const e = D.c(13),
    { clientThreadId: a, onNewThread: n } = s,
    r = It(a),
    i = Tt(a),
    c = Aa(),
    o = dt(),
    [d, m] = h.useState(!1);
  let f;
  e[0] !== d
    ? ((f = (p) => (p === ke.Snorlax ? d : !1)), (e[0] = d), (e[1] = f))
    : (f = e[1]);
  const u = f;
  let l;
  e[2] === Symbol.for("react.memo_cache_sentinel")
    ? ((l = (p, k) => {
        p === ke.Snorlax && m(k);
      }),
      (e[2] = l))
    : (l = e[2]);
  const x = l;
  let g;
  e[3] !== u
    ? ((g = {
        isSidebarFlyoutOpen: u,
        onSidebarFlyoutOpenChange: x,
      }),
      (e[3] = u),
      (e[4] = g))
    : (g = e[4]);
  const S = c ? void 0 : r;
  let j;
  e[5] !== i || e[6] !== o || e[7] !== n || e[8] !== S
    ? ((j = t.jsx("div", {
        id: "sidebar",
        className: "group/sidebar",
        children: t.jsx(qn, {
          currentGizmoId: i,
          activeId: S,
          isSnorlaxEnabled: o,
          onNewThread: n,
        }),
      })),
      (e[5] = i),
      (e[6] = o),
      (e[7] = n),
      (e[8] = S),
      (e[9] = j))
    : (j = e[9]);
  let v;
  return (
    e[10] !== g || e[11] !== j
      ? ((v = t.jsx(Ps, {
          value: g,
          children: j,
        })),
        (e[10] = g),
        (e[11] = j),
        (e[12] = v))
      : (v = e[12]),
    v
  );
}

function qn(s) {
  "use forget";
  const e = D.c(23),
    { currentGizmoId: a, activeId: n, isSnorlaxEnabled: r, onNewThread: i } = s,
    c = U();
  let o;
  e[0] !== c ? ((o = Ue(c)), (e[0] = c), (e[1] = o)) : (o = e[1]);
  const d = o,
    m = ue();
  let f;
  e[2] !== m ? ((f = m?.isQuorum()), (e[2] = m), (e[3] = f)) : (f = e[3]);
  const u = f;
  let l;
  e[4] !== d || e[5] !== i
    ? ((l =
        d &&
        t.jsx(Dn, {
          onNewThread: i,
        })),
      (e[4] = d),
      (e[5] = i),
      (e[6] = l))
    : (l = e[6]);
  let x;
  e[7] !== d ? ((x = !d && t.jsx(Je, {})), (e[7] = d), (e[8] = x)) : (x = e[8]);
  let g;
  e[9] !== d
    ? ((g = !d && t.jsx(ut, {})), (e[9] = d), (e[10] = g))
    : (g = e[10]);
  let S;
  e[11] === Symbol.for("react.memo_cache_sentinel")
    ? ((S = null), (e[11] = S))
    : (S = e[11]);
  let j;
  e[12] !== n || e[13] !== a || e[14] !== u || e[15] !== r || e[16] !== d
    ? ((j = t.jsx(H, {
        fallback: null,
        children: t.jsx(Es, {
          fallback: null,
          simulateOnce: !1,
          children: (p) => {
            const { didSuspend: k } = p;
            return t.jsxs("div", {
              className: T(k && Os.revealDown),
              id: "late-load-sidebar-items",
              children: [
                t.jsx(Ba, {
                  name: "GizmoSidebarList",
                  children: t.jsx(An, {
                    currentGizmoId: a,
                  }),
                }),
                d && t.jsx(Je, {}),
                !u &&
                  r &&
                  t.jsx(Vn, {
                    currentGizmoId: a,
                  }),
                null,
                t.jsx(Sn, {
                  activeId: n,
                }),
              ],
            });
          },
        }),
      })),
      (e[12] = n),
      (e[13] = a),
      (e[14] = u),
      (e[15] = r),
      (e[16] = d),
      (e[17] = j))
    : (j = e[17]);
  let v;
  return (
    e[18] !== l || e[19] !== x || e[20] !== g || e[21] !== j
      ? ((v = t.jsxs(t.Fragment, {
          children: [l, x, g, S, j],
        })),
        (e[18] = l),
        (e[19] = x),
        (e[20] = g),
        (e[21] = j),
        (e[22] = v))
      : (v = e[22]),
    v
  );
}

function $i(s) {
  "use forget";
  const e = D.c(4),
    { clientThreadId: a, onNewThread: n } = s,
    r = U();
  let i;
  return (
    e[0] !== a || e[1] !== r || e[2] !== n
      ? ((i = kt(r)
          ? t.jsx(Qn, {
              clientThreadId: a,
              onNewThread: n,
            })
          : null),
        (e[0] = a),
        (e[1] = r),
        (e[2] = n),
        (e[3] = i))
      : (i = e[3]),
    i
  );
}

function Kn(s) {
  "use forget";
  const e = D.c(37),
    { className: a, onNewThread: n } = s,
    r = U(),
    i = Ue(r),
    c = A(),
    o = La(Yn),
    { isFannyPackEnabled: d } = mt(),
    m = At(Ms, _s, !0, !0),
    f = mn();
  let u;
  e[0] !== c
    ? ((u = c.formatMessage({
        id: "Q6nsOM",
        defaultMessage: "Close sidebar",
      })),
      (e[0] = c),
      (e[1] = u))
    : (u = e[1]);
  const l = u,
    x = Q,
    g = ze,
    S = T("no-draggable", i && "text-token-text-tertiary"),
    j = i ? "icon-lg-heavy" : void 0,
    v = i ? Ts : m,
    p = i ? Mt : ft;
  let k;
  e[2] !== g ||
  e[3] !== l ||
  e[4] !== S ||
  e[5] !== j ||
  e[6] !== v ||
  e[7] !== p
    ? ((k = t.jsx(g, {
        className: S,
        iconClassName: j,
        "aria-label": l,
        onClick: Xn,
        icon: v,
        mobileIcon: p,
        "data-testid": "close-sidebar-button",
      })),
      (e[2] = g),
      (e[3] = l),
      (e[4] = S),
      (e[5] = j),
      (e[6] = v),
      (e[7] = p),
      (e[8] = k))
    : (k = e[8]);
  let N;
  e[9] !== x || e[10] !== l || e[11] !== k
    ? ((N = t.jsx(x, {
        label: l,
        children: k,
      })),
      (e[9] = x),
      (e[10] = l),
      (e[11] = k),
      (e[12] = N))
    : (N = e[12]);
  const C = N,
    I =
      o?.visible && o.getTitlebarAreaRect().left > 0
        ? "justify-end"
        : "justify-between";
  let b;
  e[13] !== a || e[14] !== I
    ? ((b = T("flex", I, a)), (e[13] = a), (e[14] = I), (e[15] = b))
    : (b = e[15]);
  let _;
  e[16] !== i || e[17] !== n || e[18] !== C
    ? ((_ = i
        ? t.jsx(Zn, {
            onNewThread: n,
          })
        : C),
      (e[16] = i),
      (e[17] = n),
      (e[18] = C),
      (e[19] = _))
    : (_ = e[19]);
  let w;
  e[20] !== f
    ? ((w = f && t.jsx(fn, {})), (e[20] = f), (e[21] = w))
    : (w = e[21]);
  let E;
  e[22] !== d || e[23] !== i
    ? ((E = !i && d && t.jsx(kn, {})), (e[22] = d), (e[23] = i), (e[24] = E))
    : (E = e[24]);
  let P;
  e[25] !== i || e[26] !== n
    ? ((P =
        !i &&
        t.jsx($e, {
          onClick: n,
          testId: "create-new-chat-button",
        })),
      (e[25] = i),
      (e[26] = n),
      (e[27] = P))
    : (P = e[27]);
  const W = i && C;
  let O;
  e[28] !== w || e[29] !== E || e[30] !== P || e[31] !== W
    ? ((O = t.jsxs("div", {
        className: "flex",
        children: [w, E, P, W],
      })),
      (e[28] = w),
      (e[29] = E),
      (e[30] = P),
      (e[31] = W),
      (e[32] = O))
    : (O = e[32]);
  let G;
  return (
    e[33] !== _ || e[34] !== O || e[35] !== b
      ? ((G = t.jsxs("div", {
          id: "sidebar-header",
          className: b,
          children: [_, O],
        })),
        (e[33] = _),
        (e[34] = O),
        (e[35] = b),
        (e[36] = G))
      : (G = e[36]),
    G
  );
}

function Xn() {
  K.setSidebarOpen(!1);
}

function Yn() {
  return navigator.windowControlsOverlay;
}

function Zn({ onNewThread: s, testId: e }) {
  const a = () => {
    K.setPopoverSidebarOpen(!1), s();
  };
  return t.jsx(ze, {
    onClick: a,
    icon: Fs,
    "aria-label": "",
    "data-testid": e,
    as: "link",
  });
}

function Jn({ showFreeTrialLoadingPayment: s, handleGetPaymentLink: e }) {
  const a = A(),
    n = () => {
      s || (we(!0), e());
    },
    r = (x) => {
      x.stopPropagation(), Ls(!0), As(!0);
    },
    {
      data: i,
      isLoading: c,
      isSuccess: o,
    } = Vt({
      queryKey: ["claimedReferralInvite"],
      queryFn: () => Pt.getClaimedReferralInvite(),
      refetchOnMount: !1,
      refetchOnWindowFocus: !1,
      refetchInterval: !1,
      refetchOnReconnect: !1,
    }),
    d = i?.invite_code,
    [m, f] = h.useState(!1);
  if (
    (h.useEffect(() => {
      d &&
        !m &&
        o &&
        (f(!0),
        Ce.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),
        L.logEvent("Referral: Show Claimed Sidebar Menu Promo"));
    }, [d, f, m, o]),
    !d || c || !o)
  )
    return null;
  const u = d.invite_metadata.invite_data,
    l = u?.referral_trial_duration_months
      ? u?.referral_trial_duration_months > 1
        ? a.formatMessage(Ae.monthsOfBenefit, {
            referralTrialDurationMonths: u?.referral_trial_duration_months,
          })
        : a.formatMessage(Ae.daysOfBenefit, {
            referralTrialDurationDays: u?.referral_trial_duration_days,
          })
      : null;
  return t.jsx(z.div, {
    className: T("relative", {
      "cursor-progress opacity-50": s,
    }),
    layout: "position",
    initial: {
      y: -10,
      opacity: 1,
    },
    animate: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.1,
        ease: "easeIn",
      },
    },
    children: t.jsxs(ei, {
      className: T(s && "opacity-75"),
      onClick: n,
      children: [
        t.jsxs("div", {
          className: "flex w-full flex-row items-center justify-start gap-3",
          children: [
            t.jsx(Ra, {
              className: "icon-sm shrink-0",
            }),
            t.jsx(y, {
              ...Ae.freeTrialCta,
              values: {
                duration: l,
              },
            }),
          ],
        }),
        !s &&
          t.jsx(Mt, {
            onClick: r,
            className:
              "icon-md text-token-text-tertiary shrink-0 rounded-full p-0.5 opacity-50 transition-colors duration-200 group-hover:opacity-100 hover:bg-[#0077FF] hover:text-red-500",
          }),
        t.jsx("span", {
          className:
            "absolute top-11 h-0 w-0 border-s-8 border-e-8 border-t-8 border-s-transparent border-e-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]",
        }),
      ],
    }),
  });
}
const ei = St.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,
  Ae = ce({
    freeTrialCta: {
      id: "PaymentMenuItems.freeTrialCta",
      defaultMessage: "Get {duration}!",
    },
    monthsOfBenefit: {
      id: "FreeTrialMenuItem.monthsOfBenefit",
      defaultMessage:
        "{referralTrialDurationMonths, plural, one {one month free} other {# months free}}",
    },
    daysOfBenefit: {
      id: "FreeTrialMenuItem.daysOfBenefit",
      defaultMessage:
        "{referralTrialDurationDays, plural, one {one day free} other {# days free}}",
    },
  }),
  ti = Ct(() =>
    le(
      () => import("./cdsknz6b5nh9ccla.js"),
      __vite__mapDeps([15, 3, 5, 2, 4, 6, 16, 17, 18]),
    ),
  );

function si() {
  const s = A(),
    e = za(),
    a = Da(),
    { isLoading: n, data: r } = Ua(),
    i = Ga(r),
    c = i?.hasPaidSubscription() ?? !1,
    o = i?.hasClaimedFreeTrial() ?? !1,
    d = h.useMemo(() => i?.subscriptionAnalyticsParams, [i]),
    m = async () => {
      we(!0), L.logEvent("Account Pay: Payment Checkout Clicked", d);
      try {
        const w = await Pt.getCheckoutLink(a, "PaymentMenuItems");
        window.location.href = w.url;
      } catch {
        e.warning(s.formatMessage(V.paymentErrorWarning), {
          hasCloseButton: !0,
        }),
          we(!1);
      } finally {
      }
    },
    f = () => {
      l || (we(!0), m());
    },
    u = qe((w) => w.didCloseFreeTrial),
    l = qe((w) => w.showFreeTrialLoadingPayment),
    x = !u && o,
    g = i?.wasPaidCustomer() ?? !1;
  let S = i?.isWorkspaceAccount() ?? !1;
  const j = i?.hasPaidSubscription() ?? !1,
    v = i?.isPlus() ?? !1,
    p = r && Ha(r),
    { layer: k } = Wa("2670443078");
  let N = v;
  !S && !v && p && k.get("is_gating_fix_enabled", !1) && ((N = p), (S = !0));
  const C = !n && !S,
    I = Re(),
    b = () => {
      L.logEvent("Account Pay: Click Sidebar Account Pay", d),
        zs(I, "Sidebar account payment menu item");
    },
    _ = i?.isTeam() ?? !1;
  return t.jsxs(t.Fragment, {
    children: [
      !c &&
        x &&
        t.jsx(Jn, {
          showFreeTrialLoadingPayment: l,
          handleGetPaymentLink: m,
        }),
      _ &&
        t.jsx(ai, {
          currentWorkspace: i,
        }),
      C &&
        t.jsx(xt, {
          onClick: x ? f : b,
          className: "m-0 rounded-lg px-2",
          children: t.jsx("span", {
            className: "flex w-full flex-row flex-wrap-reverse justify-between",
            children: t.jsx("div", {
              className: "flex items-center gap-2",
              children: t.jsx(ni, {
                wasPaidCustomer: g,
                showFreeTrialLoadingPayment: l,
                hasPlusSubscription: N,
                hasPaidSubscription: j,
              }),
            }),
          }),
        }),
    ],
  });
}
const ai = ({ currentWorkspace: s }) =>
    t.jsxs(t.Fragment, {
      children: [
        t.jsx(xt, {
          onClick: () => {
            K.openModal(Rs.InviteUsersToWorkspace),
              L.logEvent("Account: Invite Member Button Clicked", {
                location: "payment-menu-click",
              }),
              Ce.logEvent("chatgpt_invite_users_to_workspace", 0, {
                action: "OpenAdminInviteModal",
                location: "payment-menu-click",
                text: "AddTeammatesWithInfo",
                step: "OpenModal",
              });
          },
          className: "m-0 rounded-lg px-2",
          children: t.jsx("span", {
            className: "flex w-full flex-row flex-wrap-reverse justify-between",
            children: t.jsx("div", {
              className: "flex items-center gap-2",
              children: t.jsxs(t.Fragment, {
                children: [
                  t.jsx("span", {
                    "aria-label": "",
                    className:
                      "border-token-border-default flex h-7 w-7 items-center justify-center rounded-full border",
                    children: t.jsx(Bs, {
                      className: "icon-sm shrink-0",
                    }),
                  }),
                  t.jsx("div", {
                    className: "flex flex-col",
                    children: t.jsxs(t.Fragment, {
                      children: [
                        t.jsx("span", {
                          children: t.jsx(y, {
                            ...V.addTeammates,
                          }),
                        }),
                        t.jsx("span", {
                          className:
                            "text-token-text-tertiary line-clamp-1 text-xs",
                          children: t.jsx(y, {
                            ...V.addTeammatesUpsell,
                          }),
                        }),
                      ],
                    }),
                  }),
                ],
              }),
            }),
          }),
        }),
        s != null &&
          t.jsx(ti, {
            workspace: s,
          }),
      ],
    }),
  ni = ({
    wasPaidCustomer: s,
    showFreeTrialLoadingPayment: e,
    hasPlusSubscription: a,
    hasPaidSubscription: n,
  }) =>
    e
      ? t.jsx(Be, {
          className: "icon-sm shrink-0",
        })
      : n && !a
        ? null
        : t.jsxs(t.Fragment, {
            children: [
              t.jsx("span", {
                className:
                  "border-token-border-default flex h-7 w-7 shrink-0 items-center justify-center rounded-full border",
                children: t.jsx(Ds, {
                  className: "icon-sm",
                }),
              }),
              t.jsx("div", {
                className: "flex flex-col",
                children: s
                  ? t.jsx(y, {
                      ...V.renewPlus,
                    })
                  : t.jsxs(t.Fragment, {
                      children: [
                        t.jsx("span", {
                          children: a
                            ? t.jsx(y, {
                                ...V.viewPlans,
                              })
                            : !n &&
                              t.jsx(y, {
                                ...V.upgradePlan,
                              }),
                        }),
                        t.jsx("span", {
                          className:
                            "text-token-text-tertiary line-clamp-1 text-xs",
                          children: a
                            ? t.jsx(y, {
                                ...V.upgradeToProOrTeamUpsell,
                              })
                            : !n &&
                              t.jsx(y, {
                                ...V.upgradeToPlusUpsell,
                              }),
                        }),
                      ],
                    }),
              }),
            ],
          }),
  V = ce({
    upgradePlan: {
      id: "PaymentMenuItems.upgradePlan",
      defaultMessage: "Upgrade plan",
    },
    viewPlans: {
      id: "PaymentMenuItems.viewPlans",
      defaultMessage: "View plans",
    },
    upgradeToTeamUpsell: {
      id: "PaymentMenuItems.upgradeToTeamUpsell",
      defaultMessage: "Collaborate on a Team plan",
    },
    upgradeToProOrTeamUpsell: {
      id: "PaymentMenuItems.upgradeToProOrTeamUpsell",
      defaultMessage: "Unlimited access, team features, and more",
    },
    upgradeToPlusUpsell: {
      id: "PaymentMenuItems.upgradeToPlusUpsell.0",
      defaultMessage: "More access to the best models",
    },
    renewPlus: {
      id: "PaymentMenuItems.renewPlus",
      defaultMessage: "Renew Plus",
    },
    inviteReferral: {
      id: "PaymentMenuItems.inviteReferral",
      defaultMessage: "Refer a friend",
    },
    addTeammates: {
      id: "PaymentMenuItems.addTeammates.0",
      defaultMessage: "Add teammates",
    },
    addTeammatesUpsell: {
      id: "PaymentMenuItems.addTeammatesUpsell.0",
      defaultMessage: "Invite coworkers to ChatGPT",
    },
    paymentErrorWarning: {
      id: "PaymentMenuItems.paymentErrorWarning",
      defaultMessage:
        "The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com.",
    },
  });

function Vi({ navHeader: s, children: e, className: a }) {
  const n = A();
  return t.jsx(t.Fragment, {
    children: t.jsxs("div", {
      className:
        "draggable relative h-full w-full flex-1 items-start border-white/20",
      children: [
        t.jsx($a, {
          asChild: !0,
          children: t.jsx("h2", {
            children: t.jsx(y, {
              ...oe.chatHistoryLabel,
            }),
          }),
        }),
        t.jsxs("nav", {
          className: T(
            "relative flex h-full w-full flex-1 flex-col overflow-y-auto px-3 transition-opacity duration-500",
            a,
          ),
          "aria-label": n.formatMessage(oe.chatHistoryLabel),
          children: [
            t.jsx("div", {
              className: "bg-token-bg-elevated-secondary sticky top-0 z-30",
              children: s,
            }),
            e,
            t.jsxs(H, {
              children: [
                t.jsx("div", {
                  className: "grow",
                }),
                t.jsx(ii, {}),
              ],
            }),
          ],
        }),
      ],
    }),
  });
}

function ii() {
  const [s] = h.useState(() => {
      const r = Va.getCookie(Qa.Workspace);
      return typeof r == "string" && r !== qa;
    }),
    e = ue(),
    { isUnauthenticated: a } = Me(),
    n = !Us();
  return (s && !e) || !e
    ? null
    : a
      ? t.jsx(zt, {})
      : t.jsxs("div", {
          className:
            "bg-token-bg-elevated-secondary sticky bottom-0 z-30 flex flex-col py-2 empty:hidden dark:border-white/20",
          children: [
            t.jsx(Gs, {}),
            t.jsx(si, {}),
            n &&
              t.jsx("div", {
                className: "flex w-full items-center md:hidden",
                children: t.jsx("div", {
                  className: "max-w-[100%] grow",
                  children: t.jsx(Hs, {}),
                }),
              }),
          ],
        });
}
const zt = () => {
    const s = ht(),
      e = Ge(),
      a = gt(oe.unauthSignupCta),
      n = () => {
        e({
          authType: "login",
          callback: (o) => {
            L.logLogInButtonClicked({
              location: "Sidebar bottom unit",
              provider: o,
            }),
              Ce.logEvent("chatgpt_sidebar_login_button_clicked");
          },
        });
      },
      r = () => {
        e({
          authType: "signup",
          callback: (o) => {
            L.logSignUpButtonClicked({
              location: "Sidebar bottom unit",
              provider: o,
            }),
              Ce.logEvent("chatgpt_sidebar_signup_button_clicked");
          },
        });
      },
      i = t.jsx(
        q,
        {
          as: "button",
          size: "medium",
          color: s ? "secondary" : "primary",
          "data-testid": "signup-button",
          onClick: r,
          children: t.jsx(y, {
            ...a,
          }),
        },
        "signup-button",
      ),
      c = t.jsx(
        q,
        {
          as: "button",
          size: "medium",
          color: s ? "primary" : "secondary",
          "data-testid": "login-button",
          onClick: n,
          children: t.jsx(y, {
            ...oe.unauthLoginCta,
          }),
        },
        "login-button",
      );
    return t.jsxs("div", {
      className: "bg-token-bg-elevated-secondary sticky bottom-0 z-30 p-2",
      children: [
        t.jsxs("div", {
          className: "mt-2 mb-4",
          children: [
            t.jsx("p", {
              className: "text-token-text-primary mb-1 text-sm font-semibold",
              children: t.jsx(y, {
                ...(s ? oe.logInOrSignUp : oe.signUpOrLogIn),
              }),
            }),
            t.jsx("p", {
              className: "text-token-text-secondary text-sm",
              children: t.jsx(y, {
                id: "tr+zlt",
                defaultMessage:
                  "Get smarter responses, upload files and images, and save your conversations.",
              }),
            }),
          ],
        }),
        t.jsx("div", {
          className: "flex flex-row items-start gap-2",
          children: s ? [c, i] : [i, c],
        }),
      ],
    });
  },
  oe = ce({
    chatHistoryLabel: {
      id: "NavigationContent.chatHistoryLabel",
      defaultMessage: "Chat history",
    },
    closeSidebar: {
      id: "NavigationContent.closeSidebar",
      defaultMessage: "Close sidebar",
    },
    signInToChat: {
      id: "NavigationContent.signInToChat",
      defaultMessage: "Sign in to ChatGPT",
    },
    signUpOrLogIn: {
      id: "NavigationContent.signUpOrLogIn",
      defaultMessage: "Sign up or log in",
    },
    logInOrSignUp: {
      id: "NavigationContent.logInOrSignUp",
      defaultMessage: "Log in or sign up for free",
    },
    unauthSignupCta: {
      id: "NavigationContent.unauthSignupCta",
      defaultMessage: "Sign up",
    },
    unauthLoginCta: {
      id: "NavigationContent.unauthLoginCta",
      defaultMessage: "Log in",
    },
  }),
  ri = () => {
    const s = Re();
    return t.jsxs("div", {
      className: "flex h-full flex-col gap-2 p-3",
      children: [
        t.jsx(Kn, {
          className: "h-header-height flex items-center",
          onNewThread: () => {
            it(s);
          },
        }),
        t.jsx(oi, {}),
        t.jsx("div", {
          className: "flex items-center justify-center",
          children: t.jsx(zt, {}),
        }),
      ],
    });
  },
  Dt = "border border-token-border-xlight bg-token-sidebar-surface-secondary";

function $({ className: s, width: e }) {
  return t.jsx("div", {
    className: T("h-2.5 grow rounded-sm", Dt, s),
    style: {
      maxWidth: e + "px",
    },
  });
}

function oi() {
  const s = t.jsx("div", {
    className: T("h-4 w-4 shrink-0 grow-0 rounded-full", Dt),
  });
  return t.jsxs("div", {
    className: "mt-2 flex w-full grow flex-col gap-4 overflow-hidden px-2",
    style: {
      maskImage: "linear-gradient(to bottom, black 50%, transparent 100%)",
      WebkitMaskImage:
        "linear-gradient(to bottom, black 50%, transparent 100%)",
    },
    children: [
      t.jsxs("div", {
        className: "flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 80,
          }),
        ],
      }),
      t.jsxs("div", {
        className: "flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 120,
          }),
        ],
      }),
      t.jsxs("div", {
        className: "flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 100,
          }),
        ],
      }),
      t.jsx("div", {
        className: "mt-5 flex flex-row items-center justify-start gap-3",
        children: t.jsx($, {
          width: 150,
        }),
      }),
      t.jsxs("div", {
        className: "flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 50,
          }),
        ],
      }),
      t.jsxs("div", {
        className: "flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 100,
          }),
        ],
      }),
      t.jsxs("div", {
        className: "mb-5 flex flex-row items-center justify-start gap-3",
        children: [
          s,
          t.jsx($, {
            width: 80,
          }),
        ],
      }),
      [120, 180, 160, 100, 90, 190, 140, 120, 180, 170, 100, 120, 180, 150].map(
        (e, a) =>
          t.jsx(
            "div",
            {
              className: "flex flex-row items-center justify-start py-1",
              children: t.jsx($, {
                width: e,
              }),
            },
            a,
          ),
      ),
    ],
  });
}

function Qi({ onClick: s, className: e, ...a }) {
  return t.jsx(Vs, {
    onClick: s,
    className: T(e, "grow overflow-hidden"),
    ...a,
  });
}

function qi({ onNewChatButtonClick: s }) {
  const { isUnauthenticated: e, isLoading: a } = Me();
  return a || !e
    ? null
    : t.jsx($e, {
        className: "me-3",
        onClick: () => {
          L.logNewChatButtonClicked({
            location: "Mobile header",
          }),
            s();
        },
      });
}

function Ki({ onNewChatButtonClick: s, clientThreadId: e }) {
  const { isUnauthenticated: a, isLoading: n } = Me(),
    r = ht(),
    i = Tt(e),
    c = We(e, Et.getIsNewConversation),
    o = sn(),
    d = c && o && !a && !i;
  if (n) return null;
  if (a) return r ? t.jsx(ci, {}) : t.jsx(li, {});
  const m = t.jsx($e, {
    onClick: () => {
      L.logNewChatButtonClicked({
        location: "Mobile header",
      }),
        s();
    },
  });
  return d
    ? t.jsx($s, {
        layout: "compact",
        clientThreadId: e,
      })
    : m;
}

function li() {
  const s = Ge(),
    e = gt(Qe.signUpButtonText);
  return t.jsx(q, {
    as: "button",
    size: "small",
    color: "primary",
    onClick: () => {
      s({
        authType: "signup",
        callback: (a) => {
          L.logSignUpButtonClicked({
            location: "Mobile Chat Stage Header",
            provider: a,
          });
        },
      });
    },
    children: t.jsx(y, {
      ...e,
    }),
  });
}

function ci() {
  const s = Ge();
  return t.jsx(q, {
    as: "button",
    size: "small",
    color: "primary",
    onClick: () => {
      s({
        authType: "login",
        callback: (e) => {
          L.logLogInButtonClicked({
            location: "Mobile Chat Stage Header",
            provider: e,
          });
        },
      });
    },
    "data-testid": "mobile-login-button",
    children: t.jsx(y, {
      ...an.logInButtonText,
    }),
  });
}

function di({ onClick: s }) {
  const e = At(Ws, ft, !0, !0);
  return t.jsxs("button", {
    type: "button",
    className:
      "hover:text-token-text-primary inline-flex rounded-md focus:ring-2 focus:ring-white focus:outline-hidden focus:ring-inset active:opacity-50",
    onClick: s,
    "data-testid": "open-sidebar-button",
    children: [
      t.jsx("span", {
        className: "sr-only",
        children: t.jsx(y, {
          ...Qe.openSidebar,
        }),
      }),
      t.jsx(e, {
        className: "icon-lg text-token-text-secondary mx-2",
      }),
    ],
  });
}
const ui = ({
  rightContentExpanded: s,
  onOpenSidebar: e,
  children: a,
  showNavSidebar: n,
  leftContent: r,
  rightContent: i,
  bottomContent: c,
}) => {
  const o = _e((d) => d.isConversationScrolledFromTop);
  return t.jsxs(t.Fragment, {
    children: [
      t.jsxs("div", {
        className: T(
          "draggable h-header-height bg-token-main-surface-primary sticky top-0 z-10 flex items-center justify-center border-transparent ps-0 md:hidden",
          o
            ? "[box-shadow:var(--sharp-edge-top-shadow)]"
            : "[box-shadow:var(--sharp-edge-top-shadow-placeholder)]",
        ),
        children: [
          (n || r) &&
            t.jsxs("div", {
              className:
                "no-draggable absolute start-0 top-0 bottom-0 ms-3 inline-flex items-center justify-center",
              children: [
                n &&
                  t.jsx(di, {
                    onClick: e,
                  }),
                r,
              ],
            }),
          t.jsx("div", {
            className: "no-draggable",
            children: a,
          }),
          i &&
            t.jsx("div", {
              className: T(
                "no-draggable absolute end-0 top-0 bottom-0 me-3 inline-flex items-center justify-center",
                s && "start-10",
              ),
              children: i,
            }),
        ],
      }),
      c &&
        t.jsx("div", {
          className:
            "no-draggable bg-token-main-surface-primary flex w-full items-center justify-center md:hidden",
          children: c,
        }),
    ],
  });
};

function mi({ isPopover: s = !1, children: e }) {
  return (
    M.markStart("StageNavigationSidebar"),
    M.markRendered("StageNavigationSidebar"),
    s
      ? t.jsx(xi, {
          children: e,
        })
      : t.jsx(fi, {
          children: e,
        })
  );
}
const Ut = {
    type: "spring",
    bounce: 0.12,
    duration: 0.64,
  },
  et = {
    ...Ut,
    duration: 0.4,
  },
  fi = ({ style: s, children: e }) => (
    M.trackNamespace(M.NS_SIDEBAR),
    t.jsx(z.div, {
      className: T(
        "bg-token-sidebar-surface-primary z-21 shrink-0 overflow-x-hidden [view-transition-name:var(--sidebar-slideover)]",
      ),
      initial: {
        width: 0,
      },
      transition: Ut,
      animate: {
        width: 260,
      },
      exit: {
        width: 0,
      },
      style: s,
      children: t.jsx("div", {
        className: "h-full w-[var(--sidebar-width)]",
        children: t.jsx("div", {
          className: "flex h-full min-h-0 flex-col",
          children: e,
        }),
      }),
    })
  ),
  xi = ({ children: s }) => {
    const e = _e((a) => a.isPopoverSidebarOpen);
    return t.jsx(Ka, {
      open: e,
      onOpenChange: (a) => {
        K.setPopoverSidebarOpen(a);
      },
      children: t.jsx(Xa, {
        forceMount: !0,
        children: t.jsxs(de, {
          children: [
            e &&
              t.jsx(Ya, {
                asChild: !0,
                children: t.jsx(z.div, {
                  className:
                    "fixed inset-0 z-10 bg-gray-50/50 dark:bg-black/50",
                  transition: et,
                  initial: {
                    opacity: 0,
                  },
                  animate: {
                    opacity: 1,
                  },
                  exit: {
                    opacity: 0,
                    transition: {
                      duration: 0.12,
                    },
                  },
                }),
              }),
            e &&
              t.jsx(Za, {
                asChild: !0,
                onOpenAutoFocus: (a) => {
                  a.preventDefault();
                },
                children: t.jsxs(z.div, {
                  className:
                    "bg-token-sidebar-surface-primary top-banner-visible:bottom-0 top-banner-visible:top-(--top-banner-height,0px) top-banner-visible:h-auto fixed start-0 top-0 z-50 h-full w-[var(--sidebar-width)] max-w-xs border-e border-gray-200 shadow-[0_0_64px_0_rgba(0,0,0,0.07)] [view-transition-name:var(--sidebar-popover)] focus:outline-hidden dark:border-gray-800",
                  transition: et,
                  initial: {
                    translateX: "-100%",
                  },
                  animate: {
                    translateX: "0",
                  },
                  exit: {
                    translateX: "-100%",
                    transition: {
                      duration: 0.12,
                    },
                  },
                  children: [
                    t.jsx(Ja, {
                      asChild: !0,
                      children: t.jsxs(en, {
                        children: [
                          t.jsx(y, {
                            ...Qe.sidebarTitle,
                          }),
                          t.jsx(tn, {}),
                        ],
                      }),
                    }),
                    s,
                  ],
                }),
              }),
          ],
        }),
      }),
    });
  },
  Qe = ce({
    sidebarTitle: {
      id: "navigation.sidebarTitle",
      defaultMessage: "Sidebar",
    },
    closeSidebar: {
      id: "navigation.closeSidebar",
      defaultMessage: "Close sidebar",
    },
    openSidebar: {
      id: "navigation.openSidebar",
      defaultMessage: "Open sidebar",
    },
    signUpButtonText: {
      id: "navigation.signUpButtonText",
      defaultMessage: "Sign up",
    },
  });

function hi({ children: s }) {
  return t.jsx("div", {
    className: "bg-token-main-surface-primary h-full w-full px-[22px] py-4",
    children: s,
  });
}

function gi() {
  return t.jsxs("div", {
    className: "flex w-full gap-2",
    children: [
      t.jsx("div", {
        className: "h-6 w-6",
        children: t.jsx(me, {
          className: "h-full w-full rounded-full!",
        }),
      }),
      t.jsxs("div", {
        className: "flex w-full flex-col gap-2",
        children: [t.jsx(me, {}), t.jsx(me, {}), t.jsx(me, {}), t.jsx(me, {})],
      }),
    ],
  });
}

function fe({ icon: s, message: e, iconClassName: a }) {
  return t.jsx("div", {
    className: "loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",
    children: t.jsx(He, {
      fillIcon: !1,
      icon: s,
      className: a,
      children: t.jsx("div", {
        className: "mt-[.5px] flex h-10",
        children: e,
      }),
    }),
  });
}
const pi = ({ finalRow: s }) => {
  const e = A(),
    a = s.type === "fileOpen" ? (Qs[s.iconType] ?? qs) : null;
  return t.jsx(de, {
    children: t.jsx(z.div, {
      layout: !0,
      transition: {
        type: "spring",
        stiffness: 300,
        damping: 30,
      },
      className: "flex flex-col items-start justify-start gap-4",
      children:
        s.type === "search"
          ? t.jsx(fe, {
              icon: t.jsx(De, {
                className:
                  "text-token-text-primary relative h-5 w-5 opacity-50",
              }),
              message: e.formatMessage({
                id: "f9wsyE",
                defaultMessage: "Searchingâ€¦",
              }),
            })
          : s.type === "websiteOpen"
            ? t.jsx(fe, {
                icon: t.jsx(Ks, {
                  className:
                    "inline-flex h-5 w-5 items-center justify-center opacity-50",
                }),
                message: e.formatMessage({
                  id: "8L6BBp",
                  defaultMessage: "Readingâ€¦",
                }),
              })
            : s.type === "fileOpen"
              ? t.jsx(fe, {
                  icon: t.jsx(a, {
                    className:
                      "inline-flex h-5 w-5 items-center justify-center opacity-50",
                  }),
                  message: e.formatMessage({
                    id: "h5M4/O",
                    defaultMessage: "Reading fileâ€¦",
                  }),
                })
              : s.type === "pythonAnalysis"
                ? t.jsx(fe, {
                    icon: t.jsx(Xs, {
                      className:
                        "inline-flex h-5 w-5 items-center justify-center opacity-50",
                    }),
                    message: e.formatMessage({
                      id: "jZ7gNw",
                      defaultMessage: "Analyzingâ€¦",
                    }),
                  })
                : t.jsx(fe, {
                    icon: t.jsx(Ot, {
                      className:
                        "inline-flex h-5 w-5 items-center justify-center opacity-50",
                    }),
                    message: e.formatMessage({
                      id: "bSPYmC",
                      defaultMessage: "Thinkingâ€¦",
                    }),
                  }),
    }),
  });
};

function xe({ children: s }) {
  return t.jsx(z.div, {
    className: "w-full",
    initial: {
      opacity: 0,
    },
    animate: {
      opacity: 1,
    },
    transition: {
      duration: 1,
    },
    children: s,
  });
}
const ji = ({ previousRow: s, currentRow: e }) =>
    t.jsx("div", {
      className: "flex flex-col items-start justify-start gap-4",
      children:
        e.type === "search"
          ? t.jsx(
              xe,
              {
                children: t.jsx(Ys, {
                  row: e,
                  showIcon: !s || s.type !== "search",
                }),
              },
              `search_${e.id}`,
            )
          : e.type === "summary"
            ? t.jsx(
                xe,
                {
                  children: t.jsx(Zs, {
                    row: e,
                    showIcon: !s || s.type !== "summary",
                  }),
                },
                `summary_${e.id}`,
              )
            : e.type === "websiteOpen"
              ? t.jsx(
                  xe,
                  {
                    children: t.jsx(Js, {
                      website: e,
                    }),
                  },
                  `website_${e.id}`,
                )
              : e.type === "fileOpen"
                ? t.jsx(
                    xe,
                    {
                      children: t.jsx(ea, {
                        row: e,
                      }),
                    },
                    `file_${e.id}`,
                  )
                : e.type === "pythonAnalysis"
                  ? t.jsx(
                      xe,
                      {
                        children: t.jsx(ta, {
                          row: e,
                        }),
                      },
                      `python_${e.id}`,
                    )
                  : null,
    }),
  bi = 120,
  vi = 1e3 * 60 * 2;

function tt(s) {
  s?.scrollIntoView({
    block: "center",
    behavior: "smooth",
  });
}

function yi({ caterpillarStatusMessageTexts: s }) {
  return t.jsx("div", {
    className: "p-4",
    children: t.jsx(jt, {
      type: "error",
      title: s.failureMessage,
      content: s.failureBannerContentMessage,
    }),
  });
}

function Si({ caterpillarStatusMessageTexts: s }) {
  return t.jsx("div", {
    className: "p-4",
    children: t.jsx(jt, {
      title: s.cancelledMessage,
      content: "",
    }),
  });
}

function Ni({
  interruptPrompt: s,
  setInterruptPrompt: e,
  handleInterruptCaterpillar: a,
}) {
  const n = A();
  return t.jsxs("div", {
    className: "flex w-full flex-col justify-center gap-4 p-4",
    children: [
      t.jsx(ia, {
        ariaLabel: n.formatMessage({
          id: "aYWRtV",
          defaultMessage: "Press enter to interrupt task",
        }),
        name: "interrupt-caterpillar-prompt",
        value: s,
        onChange: (r) => e(r.target.value),
        color: "search",
        onPressEnter: a,
      }),
      t.jsx(q, {
        onClick: a,
        children: t.jsx(y, {
          id: "h73FdF",
          defaultMessage: "Interrupt task",
        }),
      }),
    ],
  });
}

function wi({ sourcesCount: s, taskInfo: e }) {
  const a = We(
      e.originalConversationId,
      (r) =>
        Et.findNode(
          r,
          (i) =>
            i.message.metadata?.b1de6e2_s === !0 &&
            i.message.metadata?.async_task_id === e.taskId,
        )?.message.metadata?.async_task_status_messages,
    ),
    n = h.useMemo(
      () =>
        a?.completed_no_time
          ? t.jsxs(t.Fragment, {
              children: [
                a?.completed_with_time ?? a?.completed_no_time,
                t.jsx(y, {
                  id: "zxfmo/",
                  defaultMessage: " Â· {sourcesCount} sources",
                  values: {
                    sourcesCount: s,
                  },
                }),
              ],
            })
          : t.jsx(y, {
              id: "YG7a0T",
              defaultMessage: "Completed Â· {sourcesCount} sources",
              values: {
                sourcesCount: s,
              },
            }),
      [s, a],
    );
  return !e.updatedAt && !a?.completed
    ? null
    : t.jsx(He, {
        icon: t.jsx(ra, {
          className: "text-token-text-secondary",
        }),
        fillIcon: !1,
        children: t.jsx("div", {
          className: "text-token-text-tertiary",
          children: n,
        }),
      });
}

function ki({
  taskInfo: s,
  caterpillarStatusMessageTexts: e,
  sourcesCount: a,
  caterpillarHeaderRef: n,
}) {
  const [r, i] = h.useState(""),
    [c, o] = h.useState(!1),
    d = nn("caterpillar-interrupts"),
    m = h.useRef(!1),
    f = h.useRef(null),
    u = h.useMemo(
      () => ((m.current = !!f.current && sa(f.current, bi)), s.rows ?? []),
      [s.rows],
    );
  h.useEffect(() => {
    if (u.length === 0) {
      const j = new Date(s.createdAt).getTime(),
        v = Date.now() - j,
        p = vi - v;
      if (p > 0) {
        const k = setTimeout(() => {
          o(!0);
        }, p);
        return () => clearTimeout(k);
      } else o(!0);
    } else o(!1);
  }, [u, s.createdAt]),
    h.useEffect(() => {
      m.current && tt(f.current);
    }, [u]),
    h.useEffect(() => {
      Ke(s) ||
        setTimeout(() => {
          f.current && tt(f.current);
        }, 100);
    }, []);
  const l = aa({
      taskId: s.taskId,
      prompt: r,
    }),
    x = Ke(s) || na(s),
    g = h.useCallback(async () => {
      await l.mutateAsync(), i("");
    }, [l, i]),
    S = h.useMemo(
      () => (u.length ? (x ? u : u.slice(0, u.length - 1)) : u),
      [u, x],
    );
  return t.jsxs("div", {
    className: "flex flex-col",
    children: [
      t.jsx(
        "div",
        {
          ref: n,
        },
        "task-header",
      ),
      t.jsxs("div", {
        className: "flex w-full flex-col gap-4",
        children: [
          t.jsx("div", {
            className: "text-base font-medium",
            children: s.title,
          }),
          u.length
            ? t.jsxs(de, {
                initial: !1,
                children: [
                  S.map((j, v) =>
                    t.jsx(
                      ji,
                      {
                        previousRow: v > 0 ? u[v - 1] : null,
                        currentRow: j,
                      },
                      j.id,
                    ),
                  ),
                  !x &&
                    t.jsx(pi, {
                      finalRow: u[u.length - 1],
                    }),
                ],
              })
            : c
              ? t.jsx(He, {
                  fillIcon: !1,
                  icon: t.jsx(Ot, {
                    className:
                      "text-token-text-primary inline-flex h-5 w-5 items-center justify-center",
                  }),
                  children: e.waitingInQueueMessage,
                })
              : t.jsx(gi, {}),
          pt(s) &&
            d &&
            t.jsx(Ni, {
              interruptPrompt: r,
              setInterruptPrompt: i,
              handleInterruptCaterpillar: g,
            }),
          s.status === "failed"
            ? t.jsx(yi, {
                caterpillarStatusMessageTexts: e,
              })
            : s.status === "cancelled"
              ? t.jsx(Si, {
                  caterpillarStatusMessageTexts: e,
                })
              : s.status === "completed"
                ? t.jsx(wi, {
                    caterpillarStatusMessageTexts: e,
                    taskInfo: s,
                    sourcesCount: a,
                  })
                : null,
        ],
      }),
      t.jsx(
        "div",
        {
          ref: f,
        },
        "task-footer",
      ),
    ],
  });
}

function Ci({ taskId: s, setWidth: e = void 0, initialTab: a }) {
  const n = oa((l) => la.getTask(s, l)),
    { closeThreadSidebar: r } = Ft(),
    [i, c] = h.useState(a),
    o = ca(),
    d = h.useRef(null),
    m = !1;
  h.useEffect(() => {
    c(a);
  }, [a]),
    h.useEffect(() => {}, [n?.taskId, n?.status, m]),
    h.useEffect(() => {}, [n?.taskId, n?.status, i]),
    h.useEffect(() => {}, [e, n, m]);
  const { uniqueSources: f, totalSources: u } = h.useMemo(() => {
    if (!n?.rows)
      return {
        uniqueSources: [],
        totalSources: 0,
      };
    const l = da(n.rows),
      x = l.reduce((g, S) => g + S.count, 0);
    return {
      uniqueSources: l,
      totalSources: x,
    };
  }, [n?.rows]);
  return t.jsx(bt, {
    handleClose: r,
    leading: t.jsx("div", {
      className: "flex w-full justify-center",
      children: t.jsx(ma, {
        activeTab: i,
        setActiveTab: c,
        showAuxTab: m,
        sourcesCount: u,
        caterpillarHeaderRef: d,
      }),
    }),
    children:
      n &&
      t.jsxs(hi, {
        children: [
          !1,
          i === "activity" &&
            t.jsx(ki, {
              taskInfo: n,
              caterpillarStatusMessageTexts: o,
              sourcesCount: u,
              caterpillarHeaderRef: d,
            }),
          i === "sources" &&
            t.jsx(ua, {
              taskIsPending: pt(n),
              finalMessage: n.finalMessage,
              sources: f,
              caterpillarHeaderRef: d,
            }),
        ],
      }),
  });
}
const st = 3;

function Ii({
  product: s,
  descriptionCitation: e,
  clientThreadId: a,
  messageId: n,
  contentReferenceStartIndex: r,
  productIndex: i,
  analyticsMetadata: c,
  offsetTopMargin: o = !1,
}) {
  const d = U(),
    m = rn(d, "3381490948"),
    [f, u] = h.useState(void 0),
    l = h.useRef([]),
    x = h.useRef([]),
    g = f?.product.offers ?? s.offers ?? [];
  for (const b of g)
    l.current.some((_) => _.merchant_name === b.merchant_name) ||
      l.current.push(b);
  const S = f?.product.image_urls ?? s.image_urls ?? [];
  for (const b of S) x.current.includes(b) || x.current.push(b);
  const [j, v] = h.useState(!1);
  h.useEffect(() => v(!1), [s]);
  const p = fa(c),
    k = xa.useStore(),
    {
      numReviews: N,
      rating: C,
      ratingGroupedCitation: I,
    } = h.useMemo(() => {
      const b = f?.product ?? s;
      return {
        numReviews: b.num_reviews,
        rating: b.rating,
        ratingGroupedCitation: b.rating_grouped_citation,
      };
    }, [s, f]);
  return t.jsxs("div", {
    className: T(
      "bg-token-bg-primary flex w-full flex-col",
      o
        ? "mt-[calc(var(--threadFlyOut-leading-height,57px)*-1)] min-h-screen"
        : "mt-0",
    ),
    children: [
      t.jsx(_i, {
        imageUrls: x.current,
        title: s.title,
        onImageClick: (b) => {
          k.setCurrentImage({
            image: {
              url: b,
              content_url: b,
              thumbnail_url: b,
              title: s.title,
              content_size: {
                width: 0,
                height: 0,
              },
              thumbnail_size: {
                width: 0,
                height: 0,
              },
            },
            source: ha.ProductDetails,
            analyticsMetadata: c,
            contentReferenceStartIndex: r,
            productIndex: i,
          });
        },
      }),
      t.jsxs("div", {
        className: "border-token-border-light flex flex-col border-t px-6 py-4",
        children: [
          t.jsx("div", {
            className: "text-token-text-primary text-xl font-semibold",
            children: s.title,
          }),
          N &&
            N > 0 &&
            t.jsxs("div", {
              className: "flex flex-col gap-1 pt-1",
              children: [
                t.jsxs("div", {
                  className:
                    "text-token-text-secondary flex flex-row items-center gap-1 text-sm text-nowrap text-ellipsis",
                  children: [
                    t.jsx(ga, {
                      rating: C ?? 0,
                    }),
                    t.jsx(y, {
                      id: "Tj10jZ",
                      defaultMessage: "{rating} ({num_reviews})",
                      values: {
                        rating: (C ?? 0).toFixed(1),
                        num_reviews: new Intl.NumberFormat().format(N),
                      },
                    }),
                    t.jsx(Q, {
                      label: t.jsx(y, {
                        id: "zngDZ6",
                        defaultMessage:
                          "Ratings and pricing are sourced from third parties which may update over time",
                      }),
                      children: t.jsx(vt, {
                        className: "h-4 w-4",
                      }),
                    }),
                  ],
                }),
                I &&
                  t.jsx(Xe, {
                    webpageItem: I,
                    trackContentReferenceEvent: p,
                    analyticsMetadata: {
                      ...c,
                      section: "products",
                      section_location: "sidebar",
                    },
                    isLastHovered: !0,
                    noMarginStart: !0,
                  }),
              ],
            }),
          s.description &&
            t.jsxs("div", {
              className: "pt-3 text-sm",
              children: [
                s.description,
                e &&
                  t.jsx(Xe, {
                    webpageItem: e,
                    trackContentReferenceEvent: p,
                    analyticsMetadata: {
                      section: "products",
                      section_location: "sidebar",
                    },
                  }),
              ],
            }),
        ],
      }),
      t.jsx(pa, {
        title: t.jsx(y, {
          id: "ITQW8G",
          defaultMessage: "Purchasing Options",
        }),
        children: t.jsxs("div", {
          className: "-mx-3 flex flex-col",
          children: [
            l.current.slice(0, j ? l.current.length : st).map((b, _) =>
              t.jsx(
                z.div,
                {
                  initial: {
                    opacity: 0,
                  },
                  animate: {
                    opacity: 1,
                  },
                  transition: {
                    duration: 0.3,
                  },
                  children: t.jsx(
                    Mi,
                    {
                      offer: b,
                      onClick: () => {
                        L.logEventWithStatsig(
                          "Product Offer Clicked",
                          "product_offer_clicked",
                          {
                            ...on(c),
                            content_reference_start_index: r,
                            product_index: i,
                            offer_index: _,
                            product_id: s.id,
                            offer_url: b.url,
                            checkout_url: b.checkout_url,
                            offers_count: l.current.length,
                          },
                        ),
                          window.open(b.checkout_url || b.url, "_blank");
                      },
                    },
                    b.url,
                  ),
                },
                b.url,
              ),
            ),
            l.current.length > st &&
              t.jsxs(q, {
                className: "w-fit px-3",
                size: "small",
                color: "ghost",
                onClick: () => v(!j),
                children: [
                  j
                    ? t.jsx(y, {
                        id: "Gl3oLS",
                        defaultMessage: "See less",
                      })
                    : t.jsx(y, {
                        id: "f9tOaY",
                        defaultMessage: "See more",
                      }),
                  j ? t.jsx(ja, {}) : t.jsx(ba, {}),
                ],
              }),
          ],
        }),
      }),
      m &&
        t.jsx(bn, {
          clientThreadId: a,
          messageId: n,
          product: s,
          trackContentReferenceEvent: p,
          onProductEntityUpdated: (b) => {
            u(b);
          },
        }),
    ],
  });
}

function _i({ imageUrls: s, title: e, onImageClick: a }) {
  const [n, r] = h.useState(0),
    i = h.useRef(null);
  return s
    ? t.jsxs("div", {
        className: "flex flex-col",
        children: [
          s[n] &&
            t.jsx(z.div, {
              className:
                "bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",
              drag: "x",
              dragConstraints: {
                left: 0,
                right: 0,
              },
              dragElastic: 0,
              onDragEnd: (c, { offset: o, velocity: d }) => {
                const m = Math.abs(o.x) * d.x;
                m < -1e3
                  ? n < s.length - 1 && r(n + 1)
                  : m > 1e3 && n > 0 && r(n - 1);
              },
              onClick: () => a(s[n]),
              children: t.jsx("img", {
                className:
                  "m-0 aspect-square w-full object-contain mix-blend-darken",
                src: s[n],
                alt: e,
                draggable: !1,
              }),
            }),
          s.length > 1 &&
            t.jsx("div", {
              ref: i,
              className:
                "no-scrollbar flex flex-row gap-2.5 overflow-x-scroll px-6 py-3",
              children: s.map((c, o) =>
                t.jsx(
                  "div",
                  {
                    className: T(
                      "flex-none cursor-pointer overflow-hidden rounded-md border-2 p-0.5",
                      n === o
                        ? "border-token-text-primary"
                        : "border-transparent",
                    ),
                    onMouseEnter: () => r(o),
                    onClick: () => a(c),
                    children: t.jsx("div", {
                      className:
                        "bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",
                      children: t.jsx("img", {
                        className:
                          "h-10 w-10 rounded-xs object-cover mix-blend-darken",
                        src: c,
                        alt: e,
                      }),
                    }),
                  },
                  `${o}-${c}`,
                ),
              ),
            }),
        ],
      })
    : null;
}

function Mi({ offer: s, onClick: e }) {
  const a = s.price_details,
    n = a?.base && (a.shipping ?? a.tax) && a.total,
    r = a?.display_price === "total_price" || n,
    i = a?.display_price === "total_price";
  let c = null;
  n && a
    ? (c = t.jsxs("div", {
        className: "space-y-1 text-sm",
        children: [
          t.jsx("div", {
            children: t.jsx(y, {
              id: "offer.breakdown.base",
              defaultMessage: "Base price: {amount}",
              values: {
                amount: a.base,
              },
            }),
          }),
          a.shipping &&
            t.jsx("div", {
              children: t.jsx(y, {
                id: "offer.breakdown.shipping",
                defaultMessage: "Shipping: {amount}",
                values: {
                  amount: a.shipping,
                },
              }),
            }),
          a.tax &&
            t.jsx("div", {
              children: t.jsx(y, {
                id: "offer.breakdown.tax",
                defaultMessage: "Tax: {amount}",
                values: {
                  amount: a.tax,
                },
              }),
            }),
        ],
      }))
    : i &&
      (c = t.jsx(y, {
        id: "ur3//V",
        defaultMessage: "Prices shown include estimated tax and shipping.",
      }));
  const o = !!s.checkout_url;
  return t.jsxs("div", {
    className: T(
      "flex cursor-pointer flex-col rounded-xl p-3",
      "hover:bg-token-bg-tertiary",
    ),
    onClick: e,
    children: [
      t.jsxs("div", {
        className: "flex flex-row items-center gap-2 text-sm font-semibold",
        children: [
          t.jsx(va, {
            className: "h-5 w-5 rounded-full",
            url: s.url,
            size: 128,
            minSize: 16,
            fallback: t.jsx(ya, {
              className: "text-token-text-tertiary",
            }),
          }),
          t.jsx("div", {
            className: "min-w-0 flex-1 truncate",
            children: s.merchant_name,
          }),
          r && c
            ? t.jsx(Q, {
                label: c,
                children: t.jsxs("span", {
                  className: "flex items-baseline",
                  children: [
                    t.jsx(vt, {
                      className: "text-token-text-secondary h-3 w-3",
                    }),
                    t.jsx("span", {
                      children: s.price,
                    }),
                  ],
                }),
              })
            : t.jsx("span", {
                children: s.price,
              }),
          t.jsx(q, {
            className: "w-fit min-w-20 truncate",
            size: "small",
            color: o ? "primary" : "secondary",
            children: o
              ? t.jsx(y, {
                  id: "LlDx51",
                  defaultMessage: "Buy now",
                })
              : t.jsx(y, {
                  id: "sTpOJt",
                  defaultMessage: "Buy",
                }),
          }),
        ],
      }),
      t.jsx("div", {
        className: "text-token-text-secondary pt-2.5 text-xs",
        children: s.product_name,
      }),
      t.jsx("div", {
        className: "text-token-text-secondary text-xs",
        children: s.details,
      }),
    ],
  });
}

function Ti({ clientThreadId: s, type: e = "sidebar" }) {
  const { closeThreadSidebar: a } = Ft(),
    {
      clientThreadId: n,
      messageId: r,
      turnIndex: i,
      contentReferenceStartIndex: c,
      productIndex: o,
    } = ln("product") ?? {},
    d = We(n, (g) => g),
    m = h.useMemo(
      () => ({
        clientThreadId: s,
        messageId: r,
        turnIndex: i,
      }),
      [s, r, i],
    );
  if (n !== s || c === void 0 || o === void 0 || !r) return null;
  const { product: f, descriptionCitation: u } = Sa({
    thread: d,
    messageId: r,
    contentReferenceStartIndex: c,
    productIndex: o,
  });
  if (!f) return null;
  const l = `${r}-${c}-${o}`,
    x = t.jsx(Ii, {
      product: f,
      descriptionCitation: u,
      clientThreadId: s,
      messageId: r,
      contentReferenceStartIndex: c,
      productIndex: o,
      analyticsMetadata: m,
      offsetTopMargin: e === "sidebar",
    });
  switch (e) {
    case "sidebar":
      return t.jsx(
        bt,
        {
          handleClose: a,
          children: x,
        },
        l,
      );
    case "modal":
      return t.jsxs(
        cn,
        {
          testId: "modal-chat-screen-product-flyout",
          className: "relative max-w-md",
          size: "custom",
          type: "success",
          noPadding: !0,
          title: f.title,
          visuallyHiddenHeader: !0,
          isOpen: !0,
          onClose: a,
          children: [
            x,
            t.jsx(dn, {
              className: "absolute end-2.5 top-2.5 z-10",
              onClick: a,
            }),
          ],
        },
        l,
      );
  }
}

function Pi({ isExpanded: s, children: e }) {
  const a = h.useRef(null),
    [n, r] = h.useState("400px"),
    i = ge.isValidElement(e)
      ? ge.cloneElement(e, {
          setWidth: r,
        })
      : e;
  return t.jsx(de, {
    children: t.jsx(z.div, {
      className:
        "bg-token-sidebar-surface-primary relative z-1 shrink-0 overflow-x-hidden max-lg:w-0!",
      ref: a,
      initial: !1,
      animate: {
        width: s ? n : 0,
        transition: {
          type: "spring",
          bounce: 0.12,
          duration: 0.3,
        },
      },
      onAnimationStart: () => {
        a.current && (a.current.style.visibility = "visible");
      },
      onAnimationComplete: () => {
        a.current && (s || (a.current.style.visibility = "hidden"));
      },
      children: t.jsx("div", {
        className: T("absolute h-full", !s && "pointer-events-none"),
        style: {
          width: n,
        },
        children: t.jsx("div", {
          className: "flex h-full flex-col",
          children: i,
        }),
      }),
    }),
  });
}
const Xi = ({ setWidth: s, clientThreadId: e }) => {
  const a = Lt(),
    n = yt();
  return a
    ? t.jsxs(t.Fragment, {
        children: [
          X(a, "searchSources") &&
            t.jsx(Na, {
              clientThreadId: e,
            }),
          X(a, "retrievalResults") &&
            t.jsx(wa, {
              clientThreadId: e,
            }),
          n &&
            X(a, "summarizer") &&
            t.jsx(ka, {
              clientThreadId: e,
            }),
          X(a, "caterpillar") &&
            t.jsx(Ci, {
              taskId: a.caterpillarId,
              initialTab: a.initialTab,
              setWidth: s,
            }),
          X(a, "product") &&
            t.jsx(Ti, {
              clientThreadId: e,
            }),
        ],
      })
    : null;
};

function Gt({
  children: s,
  hideNavigation: e = !1,
  mobileHeaderContent: a,
  mobileHeaderRightContentExpanded: n,
  mobileHeaderLeftContent: r,
  mobileHeaderRightContent: i,
  mobileHeaderBottomContent: c,
  renderNavSidebar: o,
  threadFlyout: d,
  forceOpenDesktopSidebar: m = !1,
}) {
  const { isUnauthenticated: f } = Me(),
    u = _e((w) => w.activeSidebar),
    l = un(),
    x = Ca(),
    g = Lt(),
    S = Ia(),
    j = [];
  let v = null;
  ge.Children.forEach(s, (w) => {
    ge.isValidElement(w) && (w.type === Gt.Sidebars ? (v = w) : j.push(w));
  });
  const p = !f && !e && o != null,
    k = !e && (p || f),
    N = yt(),
    C = g ? X(g, "summarizer") && N : !1,
    I = g ? !X(g, "summarizer") : !1,
    b = l && (C || I),
    _ = p && (x || m || S);
  return t.jsxs("div", {
    className: "flex h-full w-full flex-col",
    children: [
      t.jsx(H, {
        children: t.jsx(_a, {}),
      }),
      t.jsxs("div", {
        className: T(
          "relative flex h-full w-full flex-1 transition-colors",
          u !== "popover-nav" && "z-0",
        ),
        children: [
          t.jsxs("div", {
            className: "relative flex h-full w-full flex-row",
            children: [
              t.jsx(de, {
                initial: !1,
                children:
                  _ &&
                  t.jsx(mi, {
                    isPopover: x,
                    children: f ? t.jsx(ri, {}) : o?.(),
                  }),
              }),
              t.jsxs("div", {
                className: "relative flex h-full max-w-full flex-1 flex-col",
                children: [
                  k &&
                    t.jsxs(H, {
                      children: [
                        t.jsx(Ma, {}),
                        t.jsx(ui, {
                          rightContentExpanded: n,
                          onOpenSidebar: () => K.setSidebarOpen(!0),
                          showNavSidebar: p,
                          leftContent: r,
                          rightContent: i,
                          bottomContent: c,
                          children: a,
                        }),
                      ],
                    }),
                  t.jsx("main", {
                    className:
                      "transition-width relative h-full w-full flex-1 overflow-auto",
                    id: "main",
                    "z-index": "-1",
                    children: j,
                  }),
                ],
              }),
            ],
          }),
          t.jsx(H, {
            children: t.jsx(Pi, {
              isExpanded: b,
              children: d,
            }),
          }),
          v,
        ],
      }),
      t.jsx(H, {
        children: t.jsx(Ta, {
          useManuallyControlledVisibility: !0,
        }),
      }),
    ],
  });
}

function Ei({ children: s }) {
  return t.jsx(t.Fragment, {
    children: s,
  });
}
Gt.Sidebars = Ei;
export {
  $i as C,
  Xi as F,
  Vi as N,
  qn as S,
  Kn as a,
  Gt as b,
  Ki as c,
  qi as d,
  Qi as e,
};
//# sourceMappingURL=c47vptqflf6emf1m.js.map
