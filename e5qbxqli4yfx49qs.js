const __vite__mapDeps = (
  i,
  m = __vite__mapDeps,
  d = m.f ||
    (m.f = [
      "assets/gs66uw6beixieayh.js",
      "assets/lip667d8t42poxum.js",
      "assets/bek4a02po1hapmml.js",
      "assets/hgyrt6j47bbfyjrt.js",
      "assets/root-nsehtib5.css",
      "assets/conversation-small-k5k9c71c.css",
      "assets/gfnsbm99dy8f9dle.js",
      "assets/gkp5860wafdf24mv.js",
      "assets/jwvxkjptpstk4ej7.js",
      "assets/f0ztr0kzxyg0r0g8.js",
      "assets/sh55tdaqi3q0eftk.js",
      "assets/omifmppfyv316f6v.js",
      "assets/bnr1xjxexp2th2n1.js",
      "assets/kzu0w2jqm3eubkow.js",
      "assets/j5maet6kh5o0bu61.js",
      "assets/c4nq1flrjl7orjrn.js",
      "assets/irikmxrvaternf5e.js",
      "assets/k0x37ocotnu1ly9j.js",
      "assets/bszrilswpsf8hziz.js",
      "assets/eizg3cbui1uc8rqy.js",
      "assets/dcjog7s9l4t4gioj.js",
      "assets/oe646f7iouawgq3e.js",
      "assets/gxw4sxsuekoz4j4f.js",
      "assets/nfak92ny8yu3fuw0.js",
      "assets/m0f4ia5nxi8bcult.js",
      "assets/b1u7lgqe8wuqo0n9.js",
      "assets/f4f0xx2jdimom9gd.js",
      "assets/hzzn4jce92ayb7my.js",
      "assets/hayurh8u00cifole.js",
      "assets/nlrqx62vhl7xhai6.js",
      "assets/fs34l60glq014r94.js",
      "assets/dicuf8vemovnavzf.js",
      "assets/gydkbc6xtfcf9567.js",
      "assets/l4jr663ka37b6ns3.js",
      "assets/mrja6mbtdpn27l02.js",
      "assets/ocylzx9oqlg8ycwm.js",
      "assets/play-sm-1f6vhsjh.css",
      "assets/e9hw34pa6iinf5da.js",
      "assets/dh1349twprpizmeg.js",
      "assets/jy5dxk25zw6hpymq.js",
      "assets/bvff6uri7zkt0ua1.js",
      "assets/bx5pauntr9ato91c.js",
      "assets/ochx867yafjngnh2.js",
      "assets/d2pqgw5txjnon5nt.js",
      "assets/mcmdv628e0p6ma50.js",
      "assets/n0zy5hihoru8ixzo.js",
      "assets/d18ohowainhefjl7.js",
      "assets/nhyrayi3co1h1g32.js",
      "assets/ctz8d92lx4gyhixb.js",
      "assets/n913kulf1alr6s5v.js",
      "assets/FormattedText-kb0ehjj7.css",
      "assets/cot-message-lf3q5fj1.css",
      "assets/o5y4an2l8cpp7fgj.js",
      "assets/jix9nwzk33czn3ea.js",
      "assets/lb4ccra5mu2wdpv5.js",
      "assets/pe6688p8las5fhaz.js",
      "assets/iod03i092hedj52t.js",
    ]),
) => i.map((i) => d[i]);
import {
  g as Ae,
  s as Ke,
  c as y,
  aY as Ye,
  bb as $e,
  dX as X,
  dO as Qe,
  af as K,
  g8 as Ze,
  aa as Te,
  B as Z,
  aL as J,
  fb as qe,
  aj as Ge,
  c0 as es,
  ag as we,
  ae as B,
  dK as Me,
  F as te,
  h4 as ss,
  h5 as se,
  fA as ts,
  dY as as,
  ar as ns,
  eu as fe,
  et as is,
  at as os,
  e5 as rs,
  dg as ls,
  e6 as p,
  c4 as cs,
  c5 as ms,
  bL as ds,
  g7 as ge,
  X as N,
  cv as us,
  u as fs,
  dR as gs,
  _ as E,
} from "./hgyrt6j47bbfyjrt.js";
import {
  f as ae,
  r as g,
  j as e,
  M as T,
  a6 as F,
  a5 as L,
  a as xs,
} from "./lip667d8t42poxum.js";
import {
  mB as ps,
  mC as hs,
  fN as De,
  mD as _s,
  mE as ys,
  fl as js,
  fm as bs,
  au as q,
  mF as Ss,
  mG as vs,
  mH as Ns,
  mI as ks,
  lW as Es,
  mJ as Cs,
  mK as xe,
  mL as W,
  mM as pe,
  mN as As,
  V as Ts,
  L as he,
  mO as ws,
  mP as Ms,
  mQ as Ds,
  fz as Ls,
  di as Le,
  cM as Oe,
  al as Re,
  aq as Y,
  mR as Os,
  mS as Rs,
  mT as _e,
  mU as Ie,
  ea as Is,
  mV as Ps,
  mW as Fs,
  mX as Bs,
  mY as Us,
  bH as Vs,
  bG as zs,
  kr as Hs,
  mZ as Ws,
  mw as Js,
  m_ as Xs,
  m$ as Ks,
  n0 as Ys,
  az as $s,
  d8 as Qs,
  n1 as Zs,
  jS as qs,
  n2 as Gs,
  jm as ye,
  n3 as et,
  n4 as st,
  n5 as tt,
  n6 as Pe,
  j_ as at,
  n7 as nt,
  n8 as it,
  as as ot,
  n9 as rt,
  na as lt,
  nb as ct,
  nc as je,
  ec as mt,
} from "./bek4a02po1hapmml.js";
import { u as dt } from "./gfnsbm99dy8f9dle.js";
const G = {
    div: (s) => {
      const { node: n, children: t, ...a } = s;
      return e.jsx("div", { ...a, className: "text-red-500", children: t });
    },
    p: (s) => {
      const { node: n, children: t, ...a } = s;
      return e.jsx("p", {
        ...a,
        className: "text-token-text-primary text-start leading-6",
        children: t,
      });
    },
    a: (s) => {
      const { node: n, children: t, ...a } = s;
      return e.jsx("a", {
        ...a,
        className: "font-sm text-token-text-primary! leading-6",
        children: t,
      });
    },
  },
  ut = 1e3 * 60 * 2,
  ft = 30;
function Fe({
  taskId: s,
  clientThreadId: n,
  onClick: t,
  statusMessage: a,
  showSources: i,
  includeMargin: o,
  sources: l,
  progressBar: c,
}) {
  const r = De(),
    [d, u] = g.useState(!1),
    x = Ae(),
    f = Ke(x, "2007855518");
  return e.jsxs(e.Fragment, {
    children: [
      s &&
        d &&
        e.jsx(_s, { taskId: s, clientThreadId: n, onClose: () => u(!1) }),
      e.jsxs("div", {
        className: "relative flex w-4/5 max-w-[416px]",
        children: [
          s &&
            f &&
            e.jsx("button", {
              onClick: () => u(!0),
              disabled: !s,
              className:
                "hover:bg-token-bg-elevated-secondary bg-token-bg-elevated-primary absolute end-4 bottom-4 flex items-center justify-center rounded-full border border-black/10 p-0.5 dark:border-white/10",
              children: e.jsx(ys, { className: "icon-lg" }),
            }),
          e.jsx("button", {
            onClick: () => r && t(),
            className: y(
              "bg-token-main-surface-primary mt-4 flex w-full items-start justify-start gap-[18px] rounded-2xl border border-black/10 px-5 py-4 shadow-sm dark:border-white/10",
              r
                ? "hover:bg-token-main-surface-secondary cursor-pointer"
                : "cursor-auto",
            ),
            children: e.jsxs("div", {
              className: "flex w-full flex-col gap-3",
              children: [
                e.jsxs("div", {
                  className: y(
                    "flex flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between",
                    i ? "h-12" : "h-6",
                  ),
                  children: [
                    e.jsx("div", {
                      className: y(
                        "font-sm text-token-text-primary w-full flex-1 truncate text-start leading-7 md:w-0",
                        o && "me-[30px]",
                      ),
                      children: a,
                    }),
                    i && l,
                  ],
                }),
                e.jsx("div", {
                  className: y(
                    "flex w-full items-center justify-start gap-4 self-stretch pb-2",
                    s && f && "pe-10",
                  ),
                  children: c,
                }),
              ],
            }),
          }),
        ],
      }),
    ],
  });
}
function ne({
  taskId: s,
  clientThreadId: n,
  toggleSidebar: t,
  openSidebar: a,
  startTime: i,
}) {
  const o = ae(),
    [l, c] = g.useState(!1),
    r = ps();
  return (
    g.useEffect(() => {
      if (!i) return;
      const d = Date.now() - i,
        u = ut - d;
      if (u > 0) {
        const x = setTimeout(() => {
          c(!0), a();
        }, u);
        return () => clearTimeout(x);
      } else c(!0), a();
    }, [i, a]),
    e.jsx(Fe, {
      taskId: s,
      clientThreadId: n,
      onClick: t,
      statusMessage: l
        ? o.formatMessage({ id: "T2SbxC", defaultMessage: "Waiting…" })
        : e.jsx("div", {
            className:
              "text-token-text-primary text-sm font-medium text-pretty",
            children: r.startingMessage,
          }),
      progressBar: e.jsx(hs, { className: "h-2 w-full" }),
      showSources: !1,
    })
  );
}
function gt(s, n, t) {
  const a = s.formatMessage({ id: "Bs+OcV", defaultMessage: "Thinking…" });
  if (n.length < 2) return t?.initial ?? a;
  const i = n[n.length - 2];
  return i.type === "summary"
    ? i.title
    : i.type === "search"
      ? i.query
      : i?.type === "websiteOpen"
        ? e.jsx(q, { componentOverrides: G, children: i.activeRowText })
        : i.type === "fileOpen"
          ? e.jsx(q, { componentOverrides: G, children: i.activeRowText })
          : i.type === "pythonAnalysis"
            ? e.jsx(q, { componentOverrides: G, children: i.analysisSummary })
            : a;
}
function xt({
  task: s,
  clientThreadId: n,
  caterpillarRows: t,
  messageWithTaskMetadata: a,
  totalSources: i,
  handleToggleCaterpillarSidebar: o,
}) {
  const l = ae(),
    c = De(),
    r = gt(l, t, a.metadata?.async_task_status_messages),
    d = (s?.expectedDurationMinutes ?? ft) * 60 * 1e3,
    u = js(t[1]?.created_at ? t[1].created_at * 1e3 : Date.now(), d),
    x = t[1] && t[1].created_at ? u : 0;
  g.useEffect(() => {
    Ye(n, (b) => {
      b.async_status = $e.STREAMING;
    });
  }, [n]);
  const { openThreadSidebar: f } = X();
  g.useEffect(() => {
    t.length === 2 &&
      c &&
      f({
        type: "caterpillar",
        caterpillarId: s.taskId,
        initialTab: "activity",
        clientThreadId: n,
      });
  }, [t.length, f, s.taskId, n, c]);
  const _ = g.useCallback(() => {
    f({
      type: "caterpillar",
      caterpillarId: s.taskId,
      initialTab: "activity",
      clientThreadId: n,
    });
  }, [f, s.taskId, n]);
  return t.length <= 1
    ? e.jsx(ne, {
        taskId: s.taskId,
        clientThreadId: n,
        toggleSidebar: () => o("activity"),
        openSidebar: _,
        startTime: new Date(s.createdAt).getTime(),
      })
    : e.jsx(Fe, {
        taskId: s.taskId,
        clientThreadId: n,
        onClick: () => o("activity"),
        statusMessage: r,
        showSources: !0,
        includeMargin: i > 0,
        sources:
          i === 0
            ? e.jsx("div", {
                className: "text-token-text-tertiary text-sm text-pretty",
                children: e.jsx(T, {
                  id: "zfwUjs",
                  defaultMessage: "Looking for sources…",
                }),
              })
            : e.jsxs("button", {
                onClick: (b) => {
                  b.stopPropagation(), o("sources");
                },
                className: y(
                  "flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff]",
                  c ? "cursor-pointer hover:text-[#0285ff]/80" : "cursor-auto",
                ),
                children: [
                  e.jsx("div", {
                    className: "relative",
                    children: e.jsx(F, {
                      initial: !1,
                      children: e.jsx(
                        L.span,
                        {
                          initial: { opacity: 0, rotateX: -90, translateY: 20 },
                          animate: { opacity: 1, rotateX: 0, translateY: 0 },
                          exit: { opacity: 0, rotateX: 90, translateY: -20 },
                          transition: { duration: 0.35 },
                          className: "absolute start-0 md:end-0",
                          children: i,
                        },
                        i,
                      ),
                    }),
                  }),
                  e.jsx("div", {
                    className: y(
                      "md:pe-0",
                      i > 0 && "ps-2",
                      i > 9 && "ps-[14px]",
                      i > 99 && "ps-[22px]",
                    ),
                    children:
                      i > 1
                        ? e.jsx(T, { id: "zN+MuO", defaultMessage: " sources" })
                        : e.jsx(T, { id: "dMowmJ", defaultMessage: " source" }),
                  }),
                ],
              }),
        progressBar: e.jsx("div", {
          className:
            "bg-token-main-surface-tertiary flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px]",
          children: e.jsx(bs, {
            percentage: x,
            barClassName: "bg-token-text-primary",
            backgroundClassName: "bg-token-main-surface-tertiary",
          }),
        }),
      });
}
function pt({ messages: s, clientThreadId: n }) {
  const t = s.find((d) => d.metadata?.b1de6e2_s && d.metadata?.async_task_id),
    a = t?.metadata?.async_task_id,
    i = s.find((d) => d.recipient === Qe.START_RESEARCH_TASK),
    o = K(n, (d) => As(d, i?.id)),
    l = Ze({ clientThreadId: n }),
    [c, r] = g.useState(l);
  return (
    g.useEffect(() => {
      const d = setTimeout(() => {
        r(o && l);
      }, 3e3);
      return () => clearTimeout(d);
    }, [l, o]),
    !t || !a
      ? c
        ? e.jsx(ne, {
            taskId: a,
            clientThreadId: n,
            toggleSidebar: () => {},
            openSidebar: () => {},
            startTime: new Date().getTime(),
          })
        : null
      : e.jsx(ht, {
          clientThreadId: n,
          payloadTaskId: a,
          messageWithTaskMetadata: t,
        })
  );
}
function ht({
  payloadTaskId: s,
  messageWithTaskMetadata: n,
  clientThreadId: t,
}) {
  Ss(s, n, t);
  const a = vs((f) => (s ? f.tasks[s] : null)),
    i = ae(),
    o = a?.status,
    l = g.useMemo(() => (a?.rows ? a.rows : []), [a?.rows]),
    { toggleThreadSidebar: c } = X(),
    { totalSources: r, totalSearches: d } = g.useMemo(() => {
      if (!l) return { uniqueSources: [], totalSources: 0, totalSearches: 0 };
      const f = Ns(l),
        _ = f.reduce((S, k) => S + k.count, 0),
        b = ks(l);
      return { uniqueSources: f, totalSources: _, totalSearches: b };
    }, [l]),
    u = Es("caterpillar"),
    x = g.useCallback(
      (f) => {
        s &&
          c(
            {
              type: "caterpillar",
              caterpillarId: s,
              initialTab: f,
              clientThreadId: t,
            },
            u,
          );
      },
      [c, s, u, t],
    );
  return (
    Cs(s),
    n.metadata?.async_task_status_messages?.completed_with_time
      ? e.jsx(xe, {
          task: a,
          clientThreadId: t,
          messageWithTaskMetadata: n,
          totalSources: r,
          totalSearches: d,
          handleToggleCaterpillarSidebar: x,
        })
      : !a || !o || o === W.UNDETERMINED
        ? e.jsx(ne, {
            taskId: s,
            clientThreadId: t,
            toggleSidebar: () => {},
            openSidebar: () => {},
            startTime: new Date().getTime(),
          })
        : a.status === W.COMPLETED
          ? e.jsx(xe, {
              task: a,
              clientThreadId: t,
              messageWithTaskMetadata: n,
              totalSources: r,
              totalSearches: d,
              handleToggleCaterpillarSidebar: x,
            })
          : a.status === W.FAILED
            ? e.jsx(pe, {
                message:
                  n.metadata?.async_task_status_messages?.error ??
                  i.formatMessage({
                    id: "at6zk8",
                    defaultMessage: "Failed to think",
                  }),
                handleToggleCaterpillarSidebar: () => x("activity"),
              })
            : a.status === W.CANCELLED
              ? e.jsx(pe, {
                  message:
                    n.metadata?.async_task_status_messages?.cancelled ??
                    i.formatMessage({
                      id: "u1rIr5",
                      defaultMessage: "Task Cancelled",
                    }),
                  handleToggleCaterpillarSidebar: () => x("activity"),
                })
              : e.jsx(xt, {
                  task: a,
                  clientThreadId: t,
                  caterpillarRows: l,
                  messageWithTaskMetadata: n,
                  totalSources: r,
                  handleToggleCaterpillarSidebar: x,
                })
  );
}
function _t(s, n, t) {
  const a = n.elements.length;
  if (a === 0) return;
  const i = Object.entries(s).reduce(
    (o, [l, c]) =>
      Array.isArray(c) ? (c.length > 0 ? o + 1 : o) : c !== "" ? o + 1 : o,
    0,
  );
  Ge.logEventWithStatsig(
    "dynamic-form-submission",
    "chatgpt_dyanmic_form_submission",
    {
      ...es({ clientThreadId: t }),
      totalItems: a.toString(),
      completedItems: i.toString(),
      ratio: (i / a).toString(),
    },
  );
}
function yt(s, n) {
  let t = "";
  return (
    n.elements.forEach((a) => {
      const i = a.scope.split("/").pop(),
        o = i && s[i],
        l = o ? (Array.isArray(o) ? o.join(", ") : o) : "Any",
        c = a.label ?? i;
      t += `${c}: ${l}
`;
    }),
    t
  );
}
function jt({ messages: s, clientThreadId: n, isLastMessage: t }) {
  const a = s.find((v) => v.author.role === Te.Assistant),
    i = s.find((v) => v.metadata?.json_form),
    o = i?.metadata?.json_form,
    [l, c] = g.useState({}),
    [r, d] = g.useState(),
    [u, x] = g.useState(),
    f = Ts(),
    _ = dt(n);
  g.useEffect(() => {
    o && (d(o.json_form_ui), x(o.json_form_data));
  }, [o]);
  const b = g.useCallback(() => {
      if ((c({}), r)) {
        const v = {
          ...r,
          elements: r.elements.filter(
            (P) => P.scope !== "#/properties/AdditionalInfo",
          ),
        };
        d(v);
      }
      u && (delete u.properties.AdditionalInfo, x(u));
    }, [c, d, x, r, u]),
    S = g.useCallback(() => {
      if (r) {
        const v = {
          ...r,
          elements: [
            ...r.elements,
            {
              type: "Control",
              scope: "#/properties/AdditionalInfo",
              label: "Additional Info",
              placeholder: "Any other details...",
            },
          ],
        };
        d(v);
      }
      if (u) {
        const v = { ...u.properties, AdditionalInfo: { type: "string" } };
        x({ ...u, properties: v });
      }
    }, [d, x, r, u]),
    k = r?.elements.some((v) =>
      v.scope.endsWith("#/properties/AdditionalInfo"),
    ),
    M = K(n, we.getCurrentLeafId),
    C = i?.id !== M;
  if (!i || !u || !r)
    return a?.status === "in_progress" && t
      ? e.jsxs("div", {
          className: "flex flex-col gap-2",
          children: [
            e.jsx(he, { className: "h-[26px] w-full" }),
            e.jsx(he, { className: "h-[26px] w-3/4" }),
            e.jsx(ws, {}),
          ],
        })
      : null;
  if (C) return null;
  const I = async (v) => {
    const P = yt(l, r);
    _t(l, r, n),
      _({
        sourceEvent: v,
        promptMessage: qe(P),
        completionMetadata: {
          systemHints: [...f],
          conversationMode: { kind: J.PrimaryAssistant },
        },
      });
  };
  return e.jsxs(Ms, {
    children: [
      e.jsx(bt, {
        formData: l,
        dataSchema: u,
        uiSchema: r,
        setData: c,
        readOnly: C,
      }),
      e.jsxs("div", {
        className: "flex w-full justify-between",
        children: [
          k
            ? e.jsx("div", {})
            : e.jsx(Z, {
                disabled: C,
                onClick: S,
                color: "secondary",
                className: "text-token-text-secondary",
                children: e.jsx(T, {
                  id: "Sen69P",
                  defaultMessage: "Add a detail",
                }),
              }),
          e.jsxs("div", {
            className: "flex gap-2",
            children: [
              e.jsx(Z, {
                disabled: C,
                onClick: b,
                color: "secondary",
                className: "text-token-text-secondary",
                children: e.jsx(T, { id: "Uqo7UD", defaultMessage: "Reset" }),
              }),
              e.jsx(Z, {
                disabled: C,
                onClick: I,
                children: e.jsx(T, { id: "FVou++", defaultMessage: "Start" }),
              }),
            ],
          }),
        ],
      }),
    ],
  });
}
function bt({
  dataSchema: s,
  uiSchema: n,
  setData: t,
  readOnly: a,
  formData: i,
}) {
  return e.jsx("div", {
    children: e.jsx(Ds, {
      formData: i,
      readOnly: a,
      schema: s,
      uiSchema: n,
      onChange: (o) => t(o),
    }),
  });
}
const be = 4;
function St({
  navigation: s,
  onShowSearchResults: n,
  trackContentReferenceEvent: t,
}) {
  const { value: a } = B("3472722167"),
    i = s.domains.filter((r) => r.url);
  g.useEffect(() => {
    t(
      "Search Content Reference Shown",
      "search_content_reference_shown",
      s.type,
      { urls: i.map((r) => r.url).join(",") },
    );
  }, [i]);
  let o = [],
    l = [];
  const c = i[0].sub_domains.length > 0 && a;
  return (
    i.length > 3 || c ? ((o = [i[0]]), (l = i.slice(1, be))) : (o = i),
    e.jsxs("div", {
      className: y(
        "not-prose mb-3 flex gap-2",
        l.length > 0 ? "flex-col" : "flex-row",
      ),
      children: [
        o.map((r, d) =>
          e.jsx(
            Se,
            {
              isPrimaryDomain: d === 0,
              isFistLineDomain: !0,
              navigationDomain: r,
              trackContentReferenceEvent: t,
              analyticsMetadata: { section_index: d },
            },
            r.url,
          ),
        ),
        l.length > 0 &&
          e.jsxs("div", {
            className: "flex items-stretch gap-2",
            children: [
              l.map((r, d) =>
                e.jsx(
                  Se,
                  {
                    navigationDomain: r,
                    trackContentReferenceEvent: t,
                    analyticsMetadata: { section_index: o.length + d },
                  },
                  r.url,
                ),
              ),
              s.domains.length > be &&
                e.jsx(vt, {
                  onShowSearchResults: n,
                  trackContentReferenceEvent: t,
                }),
            ],
          }),
      ],
    })
  );
}
const Be = te.div`border border-token-border-default shadow-xxs hover:bg-token-main-surface-secondary dark:border-token-border-xlight dark:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-tertiary`,
  vt = ({ onShowSearchResults: s, trackContentReferenceEvent: n }) =>
    e.jsx(Be, {
      className:
        "flex w-8 cursor-pointer items-center justify-center rounded-xl",
      onClick: () => {
        n(
          "Search Content Reference Clicked",
          "search_content_reference_clicked",
          "navigation",
          { sidebar: "sidebar" },
        ),
          s(Le.Sources, Oe.Links);
      },
      children: e.jsx(Ls, { className: "opacity-50" }),
    }),
  Se = ({
    isPrimaryDomain: s,
    isFistLineDomain: n,
    navigationDomain: t,
    trackContentReferenceEvent: a,
    analyticsMetadata: i,
  }) => (
    g.useEffect(() => {
      a("link_action", "link_action", "navigation", {
        url: t.url,
        title: t.title,
        link_type: "card",
        action: "show",
        section: "fast_nav",
        section_location: "response",
        section_index: i.section_index,
      });
    }, []),
    e.jsx("div", {
      className: y("flex-1", s ? "min-w-[40%]" : "min-w-0"),
      children: e.jsx(Nt, {
        isFistLineDomain: n,
        isPrimaryDomain: s,
        title: t.title,
        subtitle: t.subtitle ?? void 0,
        url: t.url,
        domain: t.domain,
        subDomains: t.sub_domains,
        trackContentReferenceEvent: a,
        analyticsMetadata: i,
      }),
    })
  ),
  Nt = ({
    isFistLineDomain: s,
    isPrimaryDomain: n,
    title: t,
    subtitle: a,
    url: i,
    subDomains: o,
    trackContentReferenceEvent: l,
    analyticsMetadata: c,
  }) => {
    const { value: r } = B("3472722167"),
      [d, u] = g.useState(!1),
      x = {
        url: i,
        title: t,
        link_type: "card",
        section: "fast_nav",
        section_location: "response",
        section_index: c.section_index,
      };
    o.length > 0;
    const f = Me() ? "_self" : "_blank";
    return e.jsxs(Be, {
      className: "group/navigation text-token-link flex flex-col rounded-2xl",
      children: [
        e.jsxs(Re, {
          href: i,
          target: f,
          onClick: () =>
            l("link_action", "link_action", "navigation", {
              ...x,
              action: "click",
            }),
          onMouseEnter: () => {
            l("link_action", "link_action", "navigation", {
              ...x,
              action: "hover",
            });
          },
          className: y(
            "flex flex-row items-center gap-2",
            s ? "px-4 py-3" : "px-4 py-2.5",
          ),
          children: [
            e.jsx("div", {
              className:
                "flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[#1D53BF0D] group-hover/navigation:bg-[#1D53BF1A] dark:bg-[#7CA8FF33] dark:group-hover/navigation:bg-[#7CA8FF33]",
              children: e.jsx(Y, {
                url: i,
                size: 32,
                minSize: 20,
                className: "icon-sm rounded-full",
              }),
            }),
            e.jsxs("div", {
              className: "flex min-w-0 flex-col gap-0.5",
              children: [
                e.jsxs("div", {
                  className: y(
                    "flex items-center gap-1 font-semibold",
                    s ? "text-sm" : "text-xs",
                  ),
                  children: [
                    e.jsx("span", {
                      className: "flex-1 truncate",
                      children: t,
                    }),
                    !1,
                  ],
                }),
                e.jsx("div", { className: "truncate text-xs", children: a }),
              ],
            }),
          ],
        }),
        !1,
      ],
    });
  },
  ee = 3,
  kt = 3;
function Et({
  navigation: s,
  onShowSearchResults: n,
  trackContentReferenceEvent: t,
}) {
  const { value: a } = B("756982149"),
    i = g.useContext(Os) != null,
    o = g.useContext(Rs);
  return e.jsx("div", {
    className: y({ hidden: o && i }),
    children: a
      ? e.jsx(Ct, {
          navigation: s,
          onShowSearchResults: n,
          trackContentReferenceEvent: t,
        })
      : e.jsx(St, {
          navigation: s,
          onShowSearchResults: n,
          trackContentReferenceEvent: t,
        }),
  });
}
function Ct({
  navigation: s,
  onShowSearchResults: n,
  trackContentReferenceEvent: t,
}) {
  const a = s.domains.filter((l) => l.url);
  g.useEffect(() => {
    t(
      "Search Content Reference Shown",
      "search_content_reference_shown",
      s.type,
      { urls: a.map((l) => l.url).join(",") },
    );
  }, [a]);
  const i = a.slice(0, ee),
    o = a.slice(ee, ee + kt);
  return e.jsxs("div", {
    className: "not-prose mb-3 flex gap-2",
    children: [
      i.map((l, c) =>
        e.jsx(
          Tt,
          {
            isPrimaryDomain: c === 0,
            isFistLineDomain: !0,
            navigationDomain: l,
            trackContentReferenceEvent: t,
            analyticsMetadata: { section_index: c },
          },
          l.url,
        ),
      ),
      o.length > 0 &&
        e.jsx(At, {
          onShowSearchResults: n,
          trackContentReferenceEvent: t,
          moreDomains: o,
        }),
    ],
  });
}
const At = ({
    onShowSearchResults: s,
    trackContentReferenceEvent: n,
    moreDomains: t,
  }) =>
    e.jsx(Ue, {
      component: "div",
      className: "group flex w-28 cursor-pointer",
      onClick: () => {
        n(
          "Search Content Reference Clicked",
          "search_content_reference_clicked",
          "navigation",
          { sidebar: "sidebar" },
        ),
          s(Le.Sources, Oe.Links);
      },
      children: e.jsxs("div", {
        className: "flex min-w-0 flex-col",
        children: [
          e.jsx("div", {
            className: "flex items-center",
            children: t.map((a, i) =>
              e.jsx(
                "div",
                {
                  style: { zIndex: t.length - i },
                  className: "ms-[-6px] first:ms-0",
                  children: e.jsx(
                    "div",
                    {
                      className: y(
                        "flex h-4 w-4 items-center overflow-hidden rounded-full",
                        "border-token-main-surface-primary bg-token-main-surface-primary group-hover:border-token-bg-tertiary border-2",
                      ),
                      children: e.jsx(Y, {
                        url: a.url,
                        size: 32,
                        minSize: 20,
                        className: "icon-xs rounded-full",
                      }),
                    },
                    a.url,
                  ),
                },
                a.url,
              ),
            ),
          }),
          e.jsx("div", {
            className: "text-token-text-primary flex text-sm font-semibold",
            children: e.jsx("span", {
              className: "truncate",
              children: e.jsx(T, {
                id: "B5xwY8",
                defaultMessage: "More links",
              }),
            }),
          }),
        ],
      }),
    }),
  Tt = ({
    isPrimaryDomain: s,
    isFistLineDomain: n,
    navigationDomain: t,
    trackContentReferenceEvent: a,
    analyticsMetadata: i,
  }) => (
    g.useEffect(() => {
      a("link_action", "link_action", "navigation", {
        url: t.url,
        title: t.title,
        link_type: "card",
        action: "show",
        section: "fast_nav",
        section_location: "response",
        section_index: i.section_index,
      });
    }, []),
    e.jsx("div", {
      className: "min-w-0 flex-1",
      children: e.jsx(wt, {
        isFistLineDomain: n,
        isPrimaryDomain: s,
        title: t.title,
        subtitle: t.subtitle ?? void 0,
        url: t.url,
        domain: t.domain,
        subDomains: t.sub_domains,
        trackContentReferenceEvent: a,
        analyticsMetadata: i,
      }),
    })
  ),
  wt = ({
    isFistLineDomain: s,
    title: n,
    subtitle: t,
    url: a,
    trackContentReferenceEvent: i,
    analyticsMetadata: o,
  }) => {
    const l = {
        url: a,
        title: n,
        link_type: "card",
        section: "fast_nav",
        section_location: "response",
        section_index: o.section_index,
      },
      c = Me(ss()) ? "_self" : "_blank";
    return e.jsxs(Ue, {
      component: Re,
      href: a,
      target: c,
      onClick: () =>
        i("link_action", "link_action", "navigation", {
          ...l,
          action: "click",
        }),
      onMouseEnter: () => {
        i("link_action", "link_action", "navigation", {
          ...l,
          action: "hover",
        });
      },
      className: "flex flex-col gap-[2px]",
      children: [
        e.jsxs("div", {
          className:
            "text-token-text-secondary flex items-center gap-[6px] text-xs",
          children: [
            e.jsx(Y, {
              url: a,
              size: 32,
              minSize: 20,
              className: "icon-xs rounded-full",
            }),
            e.jsx("div", { className: "truncate", children: t }),
          ],
        }),
        e.jsx("div", {
          className: y(
            "text-token-text-primary flex items-center font-medium",
            s ? "text-sm" : "text-xs",
          ),
          children: e.jsx("span", { className: "truncate", children: n }),
        }),
      ],
    });
  },
  Ue = ({ component: s, children: n, className: t, ...a }) =>
    e.jsx(s, {
      ...a,
      className: y(
        "hover:bg-token-main-surface-secondary border-token-border-light rounded-2xl border px-4 py-3",
        t,
      ),
      children: n,
    }),
  Mt = 2e3,
  Ve = 0.4,
  Dt = 0.45,
  Lt = 0.2,
  Ot = 0.1,
  Rt = 0.25;
var O = ((s) => (
  (s[(s.Running = 0)] = "Running"),
  (s[(s.Finished = 1)] = "Finished"),
  (s[(s.Error = 2)] = "Error"),
  (s[(s.Stopped = 3)] = "Stopped"),
  (s[(s.Paused = 4)] = "Paused"),
  s
))(O || {});
function ga({
  conversationMessages: s,
  icon: n,
  status: t,
  text: a,
  estimatedToolDurationMs: i,
  animationLoopDurationMs: o = Mt,
  shouldPersistAfterFinished: l = !1,
}) {
  const [c, r] = g.useState(t === 0 ? 0 : t === 1 && !l ? 7 : 1),
    [d, u] = g.useState(0);
  g.useEffect(() => {
    t === 2
      ? r(8)
      : t === 3
        ? r(9)
        : t === 4
          ? r(10)
          : t === 1
            ? r(c === 2 ? 3 : 7)
            : t === 0 && c === 10 && (r(2), u((f) => f + 1));
  }, [t]);
  const x = Ft(c);
  return (
    g.useEffect(() => {
      const f = s[0].id;
      if (x)
        return (
          _e.addDelayedRenderingMessage(f),
          () => {
            _e.removeDelayedRenderingMessage(f);
          }
        );
    }, [x]),
    Ie(() => {
      R(c) && u((f) => f + 1);
    }, o),
    c === 7 && !l
      ? null
      : e.jsxs("div", {
          className: "my-2.5 flex items-center gap-2.5",
          children: [
            e.jsx(It, {
              icon: n,
              status: t,
              uiState: c,
              estimatedToolDurationMs: i,
              animationLoopCounter: d,
              shouldPersistAfterFinished: l,
              onFillProgressBarAnimationComplete: () => r(4),
              onFinishAnimationComplete: () => {
                r(5),
                  setTimeout(() => {
                    r(l ? 7 : 6);
                  }, Ot * 1e3);
              },
              onHideAnimationComplete: () => r(7),
            }),
            e.jsx(Pt, {
              text: a,
              uiState: c,
              animationLoopCounter: d,
              onEnterAnimationComplete: () => r(2),
            }),
          ],
        })
  );
}
const ve = 50;
function It({
  icon: s,
  status: n,
  uiState: t,
  estimatedToolDurationMs: a,
  animationLoopCounter: i,
  shouldPersistAfterFinished: o,
  onFillProgressBarAnimationComplete: l,
  onFinishAnimationComplete: c,
  onHideAnimationComplete: r,
}) {
  const [d, u] = g.useState(0);
  Ie(() => {
    R(t) ? u((C) => C + ve) : t === 10 && u(0);
  }, ve);
  let x, f, _;
  R(t) || t === 10
    ? ((x = "running"),
      (f = e.jsx(s, { animationLoopCounter: i })),
      (_ = "bg-transparent"))
    : t === 4 || t === 5 || (t === 7 && o)
      ? ((x = "finished"), (f = e.jsx(Fs, {})), (_ = "bg-brand-purple"))
      : n === 2
        ? ((x = "error"), (f = e.jsx(Bs, {})), (_ = "bg-orange-500"))
        : n === 3 &&
          ((x = "stopped"), (f = e.jsx(Us, {})), (_ = "bg-gray-300"));
  let b = { opacity: 0, scale: 0, rotate: -180, x: 0 },
    S = { type: "spring", bounce: 0.3, duration: Dt },
    k = { opacity: 0, scale: 0.6, rotate: 0, x: 0 };
  t === 0
    ? ((b = { opacity: 0, scale: 0.5, rotate: -180, x: -8 }),
      (S = { type: "spring", bounce: 0.3, duration: Ve }))
    : t === 1
      ? (b = !1)
      : t === 5 &&
        ((k = { opacity: 0, scale: 0, rotate: 0, x: 0 }),
        (S = { type: "spring", bounce: 0.3, duration: Rt }));
  const M = Ps(d, a);
  return e.jsx("div", {
    className: "relative h-5 w-5 shrink-0",
    children: e.jsx(F, {
      onExitComplete: () => {
        t === 6 && r();
      },
      children:
        x != null &&
        e.jsxs(
          L.div,
          {
            className: y(
              "absolute start-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",
              _,
            ),
            initial: b,
            animate: { opacity: 1, scale: 1, rotate: 0, x: 0 },
            exit: k,
            transition: S,
            onAnimationComplete: () => {
              t === 4 && c();
            },
            children: [
              f,
              (R(t) || t === 10) &&
                e.jsx(Is, {
                  percentage: t === 3 ? 100 : M,
                  thickness: 1.5 / 23,
                  className:
                    "text-brand-purple absolute start-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2",
                  backgroundStrokeClassName:
                    "stroke-brand-purple/25 dark:stroke-brand-purple/50",
                  transitionDuration:
                    t === 3 ? `${((100 - M) / 100) * Lt}s` : void 0,
                  transitionTimingFunction:
                    t === 3 ? "cubic-bezier(0.55, 0, 1, 1)" : void 0,
                  onTransitionEnd: () => {
                    t === 3 && l();
                  },
                }),
            ],
          },
          x,
        ),
    }),
  });
}
function Pt({
  text: s,
  uiState: n,
  animationLoopCounter: t,
  onEnterAnimationComplete: a,
}) {
  const [i, o] = g.useState(s);
  g.useEffect(() => {
    n === 2 && o(s);
  }, [t]),
    g.useEffect(() => {
      R(n) || o(s);
    }, [n, s]);
  let l = { opacity: 0, x: 0, y: 15 },
    c = {
      type: "spring",
      bounce: 0.3,
      opacity: { duration: 0.15 },
      y: { duration: 0.3 },
    };
  n === 0
    ? ((l = { opacity: 0, x: -8, y: 0 }),
      (c = { type: "spring", bounce: 0.3, duration: Ve, delay: 0.15 }))
    : n === 1 && (l = !1);
  const r = i ?? void 0;
  return e.jsx("div", {
    className: y(
      "relative h-5 w-full leading-5",
      n === 8 || n === 9
        ? "text-token-text-tertiary"
        : "text-token-text-secondary",
    ),
    children: e.jsx(F, {
      children:
        r != null &&
        e.jsx(
          L.div,
          {
            className: "absolute start-0 top-0 line-clamp-1 overflow-visible",
            initial: l,
            animate: { opacity: 1, x: 0, y: 0 },
            exit: { opacity: 0, x: 0, y: -15 },
            transition: c,
            onAnimationComplete: () => {
              n === 0 && a();
            },
            children: r,
          },
          r.toString(),
        ),
    }),
  });
}
function R(s) {
  return s === 0 || s === 2 || s === 3;
}
function Ft(s) {
  return R(s) || s === 4 || s === 5 || s === 6 || s === 10;
}
const Ne = te.div`group start-0 top-0 me-1.5 overflow-hidden mt-1 text-start`,
  Bt = (
    {
      highlightedCommand: s,
      status: n,
      children: t,
      showWorkUserSetting: a = !1,
      hideOnlyIfNotInteractedWith: i = !1,
      defaultExpanded: o = !1,
      onOpenAnalytics: l,
      onClick: c,
      ...r
    },
    d,
  ) => {
    const u = t != null || c != null,
      [x] = g.useState(a),
      [f, _] = g.useState(a || o),
      [b, S] = g.useState(!1),
      k = n === O.Finished || n === O.Error,
      M = i ? (x ? !1 : !b) : !1,
      C = n === O.Running && "loading-shimmer";
    return k && M
      ? null
      : u
        ? e.jsxs(e.Fragment, {
            children: [
              e.jsx(ke, {
                ref: d,
                $canShowWork: !0,
                ...r,
                children: e.jsx(F, {
                  children: e.jsx(Ne, {
                    children: e.jsx(
                      L.button,
                      {
                        onClick: (I) => {
                          f || l?.(), _((v) => !v), S(!0), c?.(I);
                        },
                        initial: { opacity: 0 },
                        animate: { opacity: 1 },
                        exit: { opacity: 0 },
                        transition: { duration: 0.3 },
                        className: y(C),
                        children: e.jsxs("div", {
                          className: "flex items-center justify-start gap-1",
                          children: [
                            e.jsx("span", {
                              className: "text-start",
                              children: s,
                            }),
                            !c &&
                              (f
                                ? e.jsx(Vs, { className: "icon-md" })
                                : e.jsx(zs, { className: "icon-md" })),
                          ],
                        }),
                      },
                      s?.toString(),
                    ),
                  }),
                }),
              }),
              e.jsx(F, {
                children:
                  f &&
                  t &&
                  e.jsx(L.div, {
                    initial: "collapsed",
                    animate: "reveal",
                    exit: "collapsed",
                    variants: {
                      collapsed: { translateY: -20, opacity: 0, height: 0 },
                      reveal: { translateY: 0, opacity: 1, height: "auto" },
                    },
                    transition: { duration: 0.3, ease: "easeInOut" },
                    className: "overflow-hidden",
                    children: t,
                  }),
              }),
            ],
          })
        : e.jsx(ke, {
            ref: d,
            $canShowWork: !1,
            ...r,
            children: e.jsx(Ne, { className: y(C), children: s }),
          });
  },
  ke = te.span`block first:mt-0 relative
${({ $canShowWork: s }) => (s ? "text-token-text-secondary hover:text-token-text-primary my-1.5" : "text-token-text-secondary")}`,
  Ut = g.forwardRef(Bt),
  Vt = 3,
  zt = 0.1,
  Ee = [0, 0.26, 0.4];
function Ht({
  nextMessage: s,
  isLastMessage: n,
  isRequestActive: t,
  isLastTurnInConversation: a,
  clientThreadId: i,
  turnIndex: o,
}) {
  const l = n || !s || (s && !se(s)),
    c = g.useRef(!1),
    r = xs(),
    d = K(i, we.getGizmoId);
  g.useEffect(() => {
    s && se(s) && !c.current && ((c.current = !0), Hs(r, d));
  }, [s, r, d]);
  const u = ts(s),
    x = as(s);
  s?.id && Ws(s?.id);
  const f = [];
  if (
    (x?.[0]?.type === "navigation" &&
      s &&
      f.push(
        e.jsx(
          Wt,
          {
            clientThreadId: i,
            turnIndex: o,
            nextMessage: s,
            isRequestActive: t,
            isLastTurnInConversation: a,
            navigationCitation: x[0],
          },
          "fast-nav",
        ),
      ),
    l)
  ) {
    const _ = ns(u.slice(0, Vt).map((S) => S.entries[0].url)),
      b = t
        ? e.jsxs("div", {
            className: "flex items-center gap-1",
            children: [
              _.map((S, k) =>
                e.jsx(
                  L.div,
                  {
                    className: y("-ms-1.5 first:ms-0 last:me-1.5", "relative"),
                    initial: { width: k === 0 ? 0 : 6, opacity: 0 },
                    animate: { width: 20, opacity: 1 },
                    transition: {
                      duration: zt,
                      delay: Ee[Math.min(k, Ee.length - 1)],
                    },
                    children: e.jsx("div", {
                      className: y(
                        "flex h-[22px] w-[22px] items-center overflow-hidden rounded-full",
                        "border-token-bg-primary bg-token-bg-primary border-2",
                      ),
                      children: e.jsx(Y, {
                        url: S,
                        size: 32,
                        minSize: 16,
                        className: "icon-md rounded-full",
                      }),
                    }),
                  },
                  S,
                ),
              ),
              e.jsx(T, { id: "jjx8Qg", defaultMessage: "Searching the web" }),
            ],
          })
        : e.jsx(T, { id: "fssXGM", defaultMessage: "Error while searching" });
    f.push(
      e.jsx(
        Ut,
        { highlightedCommand: b, status: t ? O.Running : O.Error },
        "search-gpt-query",
      ),
    );
  }
  return f.length ? e.jsx(e.Fragment, { children: f }) : null;
}
const Wt = ({
    clientThreadId: s,
    turnIndex: n,
    nextMessage: t,
    isRequestActive: a,
    isLastTurnInConversation: i,
    navigationCitation: o,
  }) => {
    const { scrollToHeader: l } = fe("searchSources") ?? {},
      c = is(),
      r = fe("searchSources"),
      { openThreadSidebar: d } = X(),
      { value: u } = B("756982148");
    return (
      g.useEffect(() => {
        os.addFirstTiming("render.fastNavigation");
      }, []),
      g.useEffect(() => {
        c &&
          r &&
          d({
            type: "searchSources",
            scrollToHeader: l,
            clientThreadId: s,
            turnIndex: n,
            messageId: t?.id ?? "",
          });
      }, []),
      g.useEffect(() => {
        const x = t,
          f = x.metadata?.search_source,
          _ = o.domains.map((b) => b.url);
        Js.logEvent(
          "Search Tool Request Time To Fast Nav",
          s,
          x.id,
          { search_source: f, urls: _ },
          () => {
            f === rs.InstantQuery &&
              Xs.logEvent("Search Tool Page Load Time To Fast Nav", {
                message_id: x.id,
                urls: _,
                search_source: f,
              });
          },
        );
      }, [s, t, o]),
      a && i && u
        ? e.jsx(L.div, {
            initial: { opacity: a ? 0 : 1, height: a ? 0 : "auto" },
            animate: { opacity: 1, height: "auto" },
            children: e.jsx(Ce, {
              clientThreadId: s,
              turnIndex: n,
              nextMessage: t,
              navigationCitation: o,
            }),
          })
        : e.jsx(Ce, {
            clientThreadId: s,
            turnIndex: n,
            nextMessage: t,
            navigationCitation: o,
          })
    );
  },
  Ce = ({
    clientThreadId: s,
    turnIndex: n,
    nextMessage: t,
    navigationCitation: a,
  }) => {
    const { toggleThreadSidebar: i } = X(),
      { value: o } = B("756982148"),
      l = g.useMemo(
        () => ({ clientThreadId: s, turnIndex: n, messageId: t?.id }),
        [s, n, t?.id],
      ),
      c = g.useCallback(
        (d, u) => {
          i({
            type: "searchSources",
            scrollToHeader: u,
            clientThreadId: s,
            turnIndex: n,
            messageId: t?.id ?? "",
          });
        },
        [i, s, n, t?.id],
      ),
      r = Ks(l);
    return o
      ? e.jsx(Et, {
          navigation: a,
          onShowSearchResults: c,
          trackContentReferenceEvent: r,
        })
      : e.jsx(Ys, {
          tldr: {
            type: "tldr",
            status: "done",
            display_title: a.domains[0].title,
            url: a.domains[0].url,
            matched_text: "",
            start_idx: 0,
            end_idx: 0,
            page_title: "",
            breadcrumbs: [a.domains[0].domain],
            refs: [],
          },
          trackContentReferenceEvent: r,
        });
  },
  Jt = N(() =>
    E(
      () => import("./gs66uw6beixieayh.js"),
      __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8]),
    ),
  ),
  Xt = N(() =>
    E(() => import("./f0ztr0kzxyg0r0g8.js"), __vite__mapDeps([9, 1, 3, 4, 10])),
  ),
  Kt = N(() =>
    E(
      () => import("./omifmppfyv316f6v.js"),
      __vite__mapDeps([11, 1, 3, 4, 2, 5]),
    ),
  ),
  Yt = N(() =>
    E(
      () => import("./bnr1xjxexp2th2n1.js"),
      __vite__mapDeps([12, 1, 3, 4, 2, 5, 13, 14, 6, 7, 8]),
    ),
  ),
  $t = N(async () => () => null);
N(async () => () => null);
const Qt = N(
    async () =>
      (
        await E(
          () => import("./c4nq1flrjl7orjrn.js"),
          __vite__mapDeps([
            15, 3, 1, 4, 13, 2, 5, 16, 17, 6, 7, 8, 18, 19, 20, 21,
          ]),
        )
      ).ImageGenMessage,
  ),
  Zt = N(() =>
    E(
      () => import("./gxw4sxsuekoz4j4f.js"),
      __vite__mapDeps([22, 1, 3, 4, 2, 5, 6, 7, 8]),
    ),
  ),
  qt = N(() =>
    E(
      () => import("./k0x37ocotnu1ly9j.js"),
      __vite__mapDeps([17, 1, 3, 4, 2, 5, 6, 7, 8]),
    ).then((s) => s.BrowsingMessage),
  ),
  Gt = N(() =>
    E(
      () => import("./nfak92ny8yu3fuw0.js"),
      __vite__mapDeps([23, 1, 3, 4, 2, 5]),
    ).then((s) => s.SearchResultMessage),
  ),
  ea = N(() =>
    E(
      () => import("./m0f4ia5nxi8bcult.js"),
      __vite__mapDeps([24, 1, 3, 4, 2, 5, 6, 7, 8]),
    ).then((s) => s.JITPluginMessage),
  ),
  sa = N(() =>
    E(
      () => import("./b1u7lgqe8wuqo0n9.js"),
      __vite__mapDeps([25, 3, 1, 4, 26, 2, 5, 27, 6, 7, 8]),
    ).then((s) => s.DataAnalysisMessage),
  ),
  ta = N(() =>
    E(
      () => import("./hayurh8u00cifole.js"),
      __vite__mapDeps([28, 1, 3, 4, 2, 5, 29]),
    ),
  ),
  aa = N(() =>
    E(
      () => import("./fs34l60glq014r94.js"),
      __vite__mapDeps([
        30, 1, 3, 4, 31, 32, 2, 5, 16, 17, 6, 7, 8, 33, 34, 35, 36, 37, 38, 39,
        40, 41, 42, 43, 44, 45, 46, 47, 27, 48, 49, 50, 51,
      ]),
    ).then((s) => s.LegacyCoTMessage),
  ),
  na = N(() =>
    E(
      () => import("./dicuf8vemovnavzf.js"),
      __vite__mapDeps([
        31, 1, 3, 4, 32, 2, 5, 16, 17, 6, 7, 8, 33, 34, 35, 36, 37, 38, 39, 40,
        41, 42, 43, 44, 45, 46, 47, 27, 48, 49, 50, 51,
      ]),
    ).then((s) => s.CoT),
  ),
  ia = N(() =>
    E(
      () => import("./o5y4an2l8cpp7fgj.js"),
      __vite__mapDeps([52, 1, 2, 3, 4, 5, 53, 54, 55, 56]),
    ).then((s) => s.JawboneMessage),
  ),
  oa = N(async () => () => null);
function xa({
  groupedMessagesToRender: s,
  allMessages: n,
  allGroupedMessages: t,
  clientThreadId: a,
  isUserTurn: i,
  isCompletionRequestInProgress: o,
  isFeedbackEnabled: l,
  isFinalTurn: c,
  isFinalUserTurn: r,
  turnIndex: d,
  hasActiveRequest: u,
  onRequestCompletion: x,
  shouldGrowContainer: f = !0,
  isParagen: _ = !1,
  renderingView: b = "chat",
}) {
  const { showDebugConversationTurns: S } = $s(),
    [k] = K(a, (m) => [m?.mode]),
    M = Qs(a),
    C = ls(a),
    I = Zs(),
    v = t.some(
      (m) =>
        m.type === p.Browsing ||
        m.type === p.RetrievalBrowsing ||
        m.type === p.SearchGPTQuery,
    ),
    P = qs(() =>
      cs.count(
        ms.DEFAULT,
        "conversation_turn_grouped_messages.attempted_render_missing_type_f959b8c",
      ),
    ),
    $ = ds(n),
    ie = Gs({ clientThreadId: a, conversationMode: k }),
    ze = g.useCallback(
      ({
        sourceEvent: m,
        requestedModelId: h,
        appendMessages: j,
        extraStreamParams: w,
      }) => {
        $ &&
          ie({
            sourceEvent: m,
            nodeId: $.id,
            requestedModelId: h,
            appendMessages: j,
            extraStreamParams: w,
          });
      },
      [$, ie],
    ),
    Q = s.map((m, h) => {
      const j = h === t.length - 1;
      if (m.type === ge)
        return e.jsx(
          na,
          {
            isStreaming: j && o,
            messageGroups: m.groups,
            isAutoswitch: M?.enableInfer,
            handleSimplerResponseClick: (A) => {
              ze({ sourceEvent: A, requestedModelId: "gpt-4o" });
            },
          },
          "cot-" + m.groups[0].messages[0].id,
        );
      const w = h === 0 ? void 0 : s[h - 1],
        ce = w?.type !== ge ? w : void 0,
        me = ce?.type,
        de = ce?.messages,
        Je = m && !se(m.messages[0]),
        Xe = v && Je,
        H = [];
      switch (
        (Xe ||
          H.push(
            e.jsx(
              ye,
              {
                className: "min-h-8",
                message: m.messages[0],
                isFeedbackEnabled: l,
                isFinalUserTurn: r,
                isCompletionInProgress: j && o,
                hasActiveRequest: u,
                turnIndex: d,
                clientThreadId: a,
                isUserTurn: i,
                prevGroupedMessageType: me,
                prevGroupedMessages: de,
              },
              "text-message-" + m.messages[0].id,
            ),
          ),
        S &&
          H.push(
            e.jsx(
              oa,
              { clientThreadId: a, message: m.messages[0] },
              "message-debug-" + m.messages[0].id,
            ),
          ),
        m.type)
      ) {
        case p.Text:
        case p.MultiText:
          return m.type === p.Text
            ? e.jsxs(
                g.Fragment,
                {
                  children: [
                    H,
                    e.jsx(nt, { isUserTurn: i, message: m.messages[0] }),
                  ],
                },
                "group-" + m.messages[0].id,
              )
            : m.type === p.MultiText
              ? e.jsx(
                  Kt,
                  {
                    clientThreadId: a,
                    messages: m.messages,
                    isCompletionInProgress: j && o,
                    isFeedbackEnabled: l,
                    hasActiveRequest: u,
                    prevGroupedMessageType: me,
                    prevGroupedMessages: de,
                  },
                  "multitext-" + (m.messages[0]?.id ?? h),
                )
              : m.type;
        case p.Browsing:
        case p.RetrievalBrowsing: {
          const A =
              k != null &&
              [J.GizmoInteraction, J.GizmoMagicCreate, J.GizmoTest].includes(
                k.kind,
              ),
            D = C ? at(C) : !1;
          return e.jsx(
            qt,
            {
              messages: m.messages,
              isRequestActive: u,
              isLastMessageInTurn: j,
              isUsingGizmo: A,
              isUsingSnorlax: D,
              isRetrieval: m.type === p.RetrievalBrowsing,
            },
            "browsing-" + (m.messages[0]?.id ?? h),
          );
        }
        case p.SearchGPTQuery: {
          const A = t
            .slice(h + 1)
            .findLast((D) => D.type === p.Text || D.type === p.CoTSearchTool);
          return e.jsx(
            Ht,
            {
              clientThreadId: a,
              turnIndex: d,
              isRequestActive: u,
              isLastMessage: j,
              isLastTurnInConversation: c,
              nextMessage: A?.messages[0],
            },
            "searchquery-" + (m.messages[0]?.id ?? h),
          );
        }
        case p.StructuredThoughts:
          return null;
        case p.ReasoningRecap:
          return null;
        case p.CoTSearchTool:
          return null;
        case p.n7jupd:
          return null;
        case p.n7jupd_i:
        case p.n7jupd_x:
          return null;
        case p.n7jupd_m: {
          if (!j) return null;
          const A = {
            ...m.messages[0],
            content: { content_type: us.Text, parts: [""] },
          };
          return e.jsx(
            ye,
            {
              className: "min-h-8",
              message: A,
              isFeedbackEnabled: l,
              isFinalUserTurn: r,
              isCompletionInProgress: j && o,
              hasActiveRequest: u,
              clientThreadId: a,
              isUserTurn: i,
              turnIndex: d,
            },
            "text-message-" + A.id,
          );
        }
        case p.a8km123: {
          if (!m.messages.some((D) => D.metadata?.model_slug === "o1-pro")) {
            const D = Pe(
              n,
              (ue) => ue.author.role === Te.Assistant && ue.recipient === "all",
            );
            return e.jsx(
              aa,
              {
                clientThreadId: a,
                turnIndex: d,
                isStreaming: (j || D < h) && o,
                messages: m.messages,
              },
              "sum-" + (m.messages[0]?.id ?? h),
            );
          }
          return e.jsx(
            ta,
            {
              messages: m.messages,
              isStreaming: j && o,
              isLastMessage: j,
              clientThreadId: a,
              currentGroupedMessageIndex: h,
              turnIndex: d,
            },
            "sum-" + (m.messages[0]?.id ?? h),
          );
        }
        case p.f959b8c:
          return P(), null;
        case p.is_loading_message:
          return j && o ? e.jsx(tt, {}, "loading-message-" + h) : null;
        case p.c12k321:
          return null;
        case p.l1p9k3u:
          return null;
        case p.b1de6e2_c:
          return e.jsx(
            jt,
            { messages: m.messages, clientThreadId: a, isLastMessage: j },
            "b1de6e2-" + (m.messages[0]?.id ?? h),
          );
        case p.b1de6e2_s:
          return e.jsx(
            pt,
            { messages: m.messages, clientThreadId: a },
            "b1de6e2_s-" + (m.messages[0]?.id ?? h),
          );
        case p.b1de6e2_d:
          return null;
        case p.b1de6e2_rm:
          return e.jsx(
            st,
            {
              messages: m.messages,
              clientThreadId: a,
              renderingView: b,
              children: H,
            },
            "b1de6e2_rm-" + (m.messages[0]?.id ?? h),
          );
        case p.de1d73e:
          if (I) {
            const A = h + 1 < t.length ? t[h + 1] : void 0;
            return e.jsx(
              ia,
              {
                clientThreadId: a,
                currentGroupedMessage: m,
                nextMessage: A && A.type === p.Text ? A.messages[0] : void 0,
                isLastMessage: j,
                isRequestActive: u,
              },
              "jawbone-" + (m.messages[0]?.id ?? h),
            );
          } else return null;
        case p.ParallelBrowsing:
          return e.jsx(
            Zt,
            { messages: m.messages },
            "parallel-" + (m.messages[0]?.id ?? h),
          );
        case p.CodeInterpreter:
          return e.jsx(
            sa,
            { messages: m.messages, isRequestActive: u, clientThreadId: a },
            "ada-" + (m.messages[0]?.id ?? h),
          );
        case p.JITPlugin:
          return e.jsx(
            ea,
            {
              messages: m.messages,
              clientThreadId: a,
              isLastTurnInConversation: c,
              onRequestCompletion: x,
            },
            "jit-" + (m.messages[0]?.id ?? h),
          );
        case p.t2uay3k:
          return e.jsx(
            Qt,
            {
              messages: m.messages,
              clientThreadId: a,
              disableClickThru: _,
              isLastTurnInConversation: c,
            },
            "t2uay3k-" + (m.messages[0]?.id ?? h),
          );
        case p.Dalle:
          return e.jsx(
            Yt,
            { messages: m.messages, clientThreadId: a, disableClickThru: _ },
            "dalle-" + (m.messages[0]?.id ?? h),
          );
        case p.GizmoEditor:
          return e.jsx(
            Jt,
            { messages: m.messages },
            "gizmo-editor-" + (m.messages[0]?.id ?? h),
          );
        case p.oiw209h:
          return e.jsx(
            $t,
            { messages: m.messages, clientThreadId: a },
            "oiw209h-" + (m.messages[0]?.id ?? h),
          );
        case p.Canmore:
          return e.jsx(
            et,
            {
              messages: m.messages,
              allTurnMessages: n,
              isFinalTurn: c,
              isRequestActive: u,
              clientThreadId: a,
              isUserTurn: i,
            },
            "canmore-" + (m.messages[0]?.id ?? h),
          );
        case p.Oboe:
          return null;
        case p.Debug:
          return S
            ? e.jsx(Xt, { message: m.messages[0] }, "debug-" + m.messages[0].id)
            : null;
        case p.SearchResult:
          return e.jsx(
            Gt,
            { messages: m.messages },
            "search-result-" + (m.messages[0]?.id ?? h),
          );
        case p.kanzi:
          return null;
      }
    }),
    He = ct(),
    We = Ae(),
    { wordFadeType: U } = it(),
    V = g.useRef([]),
    oe = g.useRef(void 0),
    re = g.useRef(null),
    z = !i && c && o,
    le = n[0]?.id;
  return (
    fs(() => {
      if (U !== "indexed" || !z) return;
      const m = re.current;
      if (!m) return;
      oe.current !== le && ((oe.current = le), (V.current = []));
      const h = m
        .getAnimations({ subtree: !0 })
        .filter((j) => j.animationName === je["fade-in"]);
      if (h.length !== 0) {
        const j = ca({
          now: performance.now(),
          previousStartTimes: V.current,
          groupCount: h.length,
        });
        V.current = j;
        for (let w = 0; w < h.length; w++) h[w].startTime = j[w];
      } else V.current = [];
    }, [Q, U, z]),
    e.jsx("div", {
      className: y({
        "flex max-w-full flex-col": !0,
        [je.root]: U === "indexed" && z,
        grow: f,
      }),
      ref: re,
      children: e.jsx(gs, {
        name: "GroupedMessages",
        fallback: ra,
        children: i
          ? Q
          : e.jsxs(
              ot,
              {
                isDisabled: !z || U !== "delay",
                children: [
                  rt(We) && c && e.jsx(lt, { isStreaming: o, debug: He }),
                  Q,
                ],
              },
              n[0]?.id,
            ),
      }),
    })
  );
}
function ra({ error: s }) {
  return e.jsxs(mt, {
    type: "danger",
    children: [
      e.jsx(T, {
        id: "5eGo3w",
        defaultMessage: "Unable to display this message due to an error.",
      }),
      !1,
    ],
  });
}
function la(s, n, t) {
  if (s.length < 2 || n <= 0) return 0;
  const a = n / Math.log(2);
  s = [...s].sort((l, c) => l - c);
  let i = 0,
    o = 0;
  for (let l = s.length - 1; l > 0; --l) {
    const c = Math.exp(-(t - s[l]) / a);
    if (i > 0 && c / i < 0.01) break;
    const r = s[l] - s[l - 1];
    (i += c), (o += c * r);
  }
  return i === 0 ? 0 : i / o;
}
function ca({
  now: s,
  previousStartTimes: n,
  groupCount: t,
  initialRate: a = 50,
  halfLife: i = 1,
}) {
  const o = n.slice(0, Pe(n, (u) => u <= s) + 1),
    l = o.length < 2 ? a / 1e3 : Math.max(0.01, la(o, i * 1e3, s)),
    c = t - o.length;
  let r = o[o.length - 1] ?? 0,
    d = 1;
  for (let u = 0; u < c; u++) {
    const x = l * 1e3 * d;
    c < x ? (d *= 0.8) : c > x && (d *= 1.5);
    const f = 1 / (l * d),
      _ = Math.max(s, r + f);
    o.push(_), (r = _);
  }
  return o;
}
export { xa as C, Ce as F, Et as N, O as T, Ut as a, ga as b };
//# sourceMappingURL=e5qbxqli4yfx49qs.js.map
